<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Guo Shiwei" />

<meta name="date" content="2019-01-18" />

<title>Introduction to StatComp18092</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to StatComp18092</h1>
<h4 class="author"><em>Guo Shiwei</em></h4>
<h4 class="date"><em>2019-01-18</em></h4>



<div id="question" class="section level2">
<h2>Question</h2>
<p>Write a .Rmd file to implement at least three examples of different types in the above books (texts, numerical results, tables, and figures).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>I will implement four simple examples of different types.</p>
<ul>
<li>figure</li>
</ul>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>numerical results</li>
</ul>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<ul>
<li>text</li>
</ul>
<pre><code>## 
## Call:
## lm(formula = a[, 1] ~ a[, 2])
## 
## Residuals:
##        1        2        3        4 
##  0.15620 -0.12590  0.07151 -0.10181 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)   0.9251     0.1442   6.414   0.0235 *
## a[, 2]       -1.1518     0.6874  -1.676   0.2358  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.1669 on 2 degrees of freedom
## Multiple R-squared:  0.584,  Adjusted R-squared:  0.3761 
## F-statistic: 2.808 on 1 and 2 DF,  p-value: 0.2358</code></pre>
<ul>
<li>table</li>
</ul>
<pre><code>## x
##  1  2  3  4  5  6  7  8  9 10 
##  2  3  7  5  6  7  3  1  4  2</code></pre>
<p>The answer is good and there is no problem.</p>
<p>My R code is</p>
<p>set.seed(12345) x &lt;- rnorm(10) y &lt;- rnorm(10) plot(x, y)</p>
<p>seq(1,10)</p>
<p>a= matrix(runif(8),4,2) dimnames(a)=list(NULL,c(“x”,“y”)) summary(lm(a[,1]~a[,2]))</p>
<p>x &lt;- rpois(40, lambda=5) table(x)</p>
<p>thank you for reading</p>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>3.5 A discrete random variable $X has probability mass function <span class="math display">\[\frac{x}{p(x)}\frac{0}{0.1}\frac{1}{0.2}\frac{2}{0.2}\frac{3}{0.2}\frac{4}{0.3}\]</span> Use the inverse transform method to generate a random sample of size 1000 from the distribution of X. Construct a relative frequency table and compare the empirical with the theoretical probabilities. Repeat using the R sample function.</p>
<p>3.7</p>
<p>Write a function to generate a random sample of size n from the Beta(a, b) distribution by the acceptance-rejection method. Generate a random sample of size 1000 from the Beta(3,2) distribution. Graph the histogram of the sample with the theoretical Beta(3,2) density superimposed.</p>
<p>3.12</p>
<p>Simulate a continuous Exponential-Gamma mixture. Suppose that the rate parameter ?? has Gamma(r, ??) distribution and <span class="math inline">\(Y\)</span> has Exp(<span class="math inline">\(??\)</span>) distribution. That is, <span class="math inline">\((Y |?? = ??) \sim f_Y (y|??) = ??e^{-\lambda y}\)</span>. Generate 1000 random observations from this mixture with <span class="math inline">\(r\)</span> = 4 and <span class="math inline">\(??\)</span> = 2.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>3.5</p>
<p>I will use inverse transformation in discrete distribution to solve this problem.</p>
<p>We can generate a random sample by inverse transform method:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">12345</span>);
<span class="co"># x </span>
x=<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>);
<span class="co"># p</span>
p=<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>);
cp=<span class="kw">cumsum</span>(p);
m=<span class="dv">1000</span>;r=<span class="kw">numeric</span>(m);
<span class="co"># inverse transform method</span>
r=x[<span class="kw">findInterval</span>(<span class="kw">runif</span>(m),cp)<span class="op">+</span><span class="dv">1</span>];
r</code></pre></div>
<pre><code>##    [1] 4 4 4 4 2 1 2 3 4 4 0 1 4 0 2 2 2 2 1 4 2 2 4 4 3 2 3 3 1 2 4 0 1 3
##   [35] 2 2 4 4 3 1 4 2 4 4 1 2 0 0 0 3 4 4 2 1 4 2 4 0 2 1 4 1 4 4 4 1 4 1
##   [69] 3 4 3 3 2 2 0 3 4 3 3 1 4 3 0 0 1 2 4 3 4 0 4 4 0 3 4 3 4 4 0 2 1 3
##  [103] 4 3 3 4 3 4 1 1 3 2 4 2 4 4 4 3 0 2 3 3 0 3 4 4 4 1 1 4 0 3 4 3 4 4
##  [137] 3 1 0 4 3 3 1 3 1 4 4 2 4 2 4 3 4 2 1 4 3 2 4 3 4 3 4 4 2 2 4 1 4 2
##  [171] 4 1 4 2 2 4 4 4 4 4 1 2 1 1 4 4 2 4 1 1 4 4 2 2 4 0 1 4 1 2 3 4 1 3
##  [205] 3 4 0 0 3 3 1 3 2 1 4 2 2 3 3 1 1 1 0 3 4 4 4 2 2 3 2 3 2 3 4 3 4 4
##  [239] 2 2 4 4 4 4 3 3 4 3 2 4 1 4 0 1 4 4 0 1 1 2 4 4 4 4 4 0 1 4 4 3 1 2
##  [273] 1 4 4 2 3 0 2 4 1 4 0 0 1 2 0 4 3 3 4 4 0 2 4 1 4 1 3 0 0 3 4 3 3 3
##  [307] 1 1 2 2 2 2 4 1 2 4 3 3 1 4 2 3 3 2 2 4 2 0 1 1 2 4 4 3 1 0 4 4 2 4
##  [341] 3 3 4 4 3 3 4 4 0 4 3 3 4 3 3 4 3 3 0 4 1 1 2 1 2 4 4 1 4 3 3 4 4 3
##  [375] 3 2 2 4 2 2 4 4 2 3 4 4 3 1 4 0 4 4 4 1 2 1 2 2 3 1 0 2 1 1 3 1 4 1
##  [409] 4 0 3 4 0 0 4 4 3 2 2 1 4 1 1 1 2 4 4 2 1 3 3 0 4 2 0 3 0 4 3 1 4 4
##  [443] 0 3 2 4 2 0 4 4 4 2 2 4 3 3 4 1 3 0 3 4 1 4 3 2 3 2 4 1 2 2 4 3 1 2
##  [477] 4 4 3 1 1 1 1 3 2 3 1 4 2 4 4 4 4 3 2 2 4 4 4 4 1 4 4 4 3 4 0 3 2 4
##  [511] 4 2 2 3 2 3 1 1 1 4 4 1 4 3 2 1 2 3 4 4 2 2 3 3 3 4 1 4 1 2 1 2 1 3
##  [545] 4 3 0 3 3 4 4 2 3 4 2 1 1 0 3 2 0 0 3 3 1 1 4 3 4 1 3 3 3 1 1 2 4 1
##  [579] 4 3 2 4 1 2 2 3 3 4 1 0 3 1 0 4 1 3 1 4 3 4 3 0 3 4 2 4 4 4 2 2 3 1
##  [613] 4 1 3 0 2 3 4 1 1 4 2 1 4 4 4 3 4 2 2 2 1 0 0 2 4 1 1 1 3 3 4 2 4 3
##  [647] 3 4 0 3 4 2 3 3 3 4 1 2 4 1 4 0 3 4 3 2 4 1 3 3 3 0 0 4 4 1 3 2 3 0
##  [681] 4 1 2 4 4 3 4 4 2 4 2 4 1 0 4 4 0 4 4 2 3 2 2 1 0 4 1 4 4 2 2 4 3 2
##  [715] 3 2 3 4 1 1 2 0 0 0 3 0 2 0 3 3 4 3 3 4 4 3 4 1 2 4 2 0 4 4 3 0 4 2
##  [749] 4 4 1 4 4 2 0 1 4 4 4 0 2 1 2 3 3 4 1 4 3 1 2 4 4 2 4 2 1 0 2 4 4 2
##  [783] 3 3 3 4 2 2 3 2 3 1 4 0 3 4 2 2 0 2 4 4 3 0 3 1 1 1 1 1 4 2 2 3 2 4
##  [817] 1 4 1 3 1 3 2 4 4 1 3 4 1 0 2 3 3 2 1 2 1 3 4 3 3 1 3 3 1 3 3 1 4 2
##  [851] 2 4 4 2 1 2 4 3 4 3 1 0 2 4 3 3 1 0 3 4 3 1 4 3 4 2 4 0 4 1 3 2 4 2
##  [885] 3 4 4 2 4 0 3 1 1 0 0 1 3 2 1 1 4 1 4 2 1 0 2 3 4 1 4 1 4 4 2 4 1 2
##  [919] 3 2 0 4 2 3 3 1 1 0 2 4 1 3 1 4 1 3 0 2 2 3 4 3 2 4 0 4 4 3 4 3 2 2
##  [953] 1 1 2 2 2 1 2 2 2 3 2 3 2 3 3 2 0 4 3 4 4 4 3 3 3 2 3 4 1 2 4 4 2 2
##  [987] 0 4 2 0 3 1 1 3 1 4 2 1 2 1</code></pre>
<p>By calcution, we wil get an elative frequency table:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(r)<span class="op">/</span>m</code></pre></div>
<pre><code>## r
##     0     1     2     3     4 
## 0.093 0.177 0.199 0.218 0.313</code></pre>
<p>Using R sample function, we will get an another relative frequency table:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="dt">size=</span><span class="dv">1000</span>,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>));
<span class="kw">table</span>(a)<span class="op">/</span><span class="dv">1000</span></code></pre></div>
<pre><code>## a
##     0     1     2     3     4 
## 0.099 0.224 0.207 0.190 0.280</code></pre>
<p>theoretical probabilities are:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># theoretical probabilities</span>
<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>)</code></pre></div>
<pre><code>## [1] 0.1 0.2 0.2 0.2 0.3</code></pre>
<p>We find that they are similar. The answer is reasonable.</p>
<p>3.7</p>
<p>First, I will creat a function to generate a random sample using acceptance-rejection method. Then I will using this function to generate a random sample of size 1000 and graph the histogram of it.</p>
<p>The function is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">get.beta=<span class="cf">function</span>(n,a,b){
  y=<span class="kw">numeric</span>(n)
  k=<span class="dv">0</span>
  <span class="cf">while</span>(k<span class="op">&lt;</span>n){
    u=<span class="kw">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span><span class="op">/</span><span class="kw">beta</span>(a,b))
    x=<span class="kw">runif</span>(<span class="dv">1</span>)
    <span class="cf">if</span>(u<span class="op">&lt;</span>x<span class="op">^</span>(a<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">^</span>(b<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="kw">beta</span>(a,b)){
      <span class="co">#we accept x</span>
      k=k<span class="op">+</span><span class="dv">1</span>
      y[k]=x
    }
  }
  <span class="kw">return</span>(y)
}</code></pre></div>
<p>generate a random simple of size 1000 from the Beta(3,2) distribution:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ues the function I just created</span>
a=<span class="kw">get.beta</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">2</span>)
a</code></pre></div>
<pre><code>##    [1] 0.4578478 0.7697757 0.6999145 0.9449553 0.4640286 0.7624432
##    [7] 0.2446607 0.5324479 0.7739790 0.9186360 0.6022072 0.5511563
##   [13] 0.3347412 0.3659745 0.9430204 0.3775094 0.8118346 0.7895681
##   [19] 0.7302311 0.7473009 0.9578598 0.6029672 0.2641025 0.6965469
##   [25] 0.7429009 0.7967362 0.5883118 0.4033990 0.5006497 0.5029776
##   [31] 0.6327080 0.7320820 0.7815213 0.4687478 0.5755680 0.5130378
##   [37] 0.3217781 0.5123951 0.8094356 0.6614758 0.6197908 0.8313120
##   [43] 0.7009846 0.5307307 0.8034642 0.3731900 0.4187686 0.8389895
##   [49] 0.4413062 0.6761481 0.9160300 0.6299933 0.4094396 0.5899135
##   [55] 0.6080707 0.5349854 0.4803662 0.5127571 0.1491237 0.5725205
##   [61] 0.7933691 0.8282804 0.7577026 0.1954568 0.4490412 0.8033197
##   [67] 0.5802189 0.2709804 0.8179400 0.9047577 0.2244381 0.5516709
##   [73] 0.5878063 0.5054890 0.8884102 0.5236222 0.8822473 0.8729198
##   [79] 0.6928481 0.7510120 0.7494651 0.7491769 0.7698602 0.2993368
##   [85] 0.7303784 0.7079438 0.6066068 0.8787144 0.7137869 0.8052462
##   [91] 0.6108035 0.9214197 0.3606903 0.4976413 0.4634775 0.6085691
##   [97] 0.4219095 0.3803063 0.2921250 0.3089585 0.7961831 0.2529828
##  [103] 0.1905465 0.5895713 0.6216918 0.2419511 0.8761783 0.7645184
##  [109] 0.6842414 0.8658031 0.9380891 0.5269814 0.6222208 0.5775089
##  [115] 0.5663421 0.8621600 0.4246155 0.6697191 0.1563615 0.7349870
##  [121] 0.5162569 0.7931586 0.7330762 0.6184472 0.8210526 0.6954465
##  [127] 0.7925756 0.2627319 0.3556632 0.6224167 0.5615456 0.8264012
##  [133] 0.7541990 0.3416507 0.2682755 0.4866295 0.6646649 0.4643730
##  [139] 0.5538304 0.4378610 0.7616317 0.7189438 0.3580879 0.4951297
##  [145] 0.6965404 0.5500420 0.2232913 0.7558654 0.5643375 0.7359274
##  [151] 0.8283955 0.6623475 0.8309047 0.5856770 0.6396256 0.2316759
##  [157] 0.7188935 0.8168370 0.8362571 0.6388770 0.5659700 0.5958866
##  [163] 0.8232618 0.3007703 0.4022732 0.6507935 0.4964417 0.5094797
##  [169] 0.3811865 0.6349854 0.8087743 0.2838828 0.6380252 0.6053015
##  [175] 0.5971038 0.3192937 0.7138754 0.5307763 0.8515736 0.7349568
##  [181] 0.5796719 0.4151286 0.6308397 0.4310413 0.3709918 0.8676651
##  [187] 0.5593648 0.5033211 0.6716217 0.7939405 0.6233479 0.4731763
##  [193] 0.6410733 0.7470011 0.2604776 0.8098738 0.9269443 0.6677758
##  [199] 0.6238352 0.7389861 0.6294342 0.7690051 0.6359522 0.8220791
##  [205] 0.6521558 0.7159469 0.5317709 0.3559376 0.2071122 0.5584804
##  [211] 0.5739337 0.3106080 0.5163248 0.3767119 0.8311837 0.5819000
##  [217] 0.6119156 0.5786600 0.7436426 0.7718054 0.4846461 0.2847368
##  [223] 0.5246778 0.4854045 0.6410911 0.7848067 0.5827542 0.6414473
##  [229] 0.3647043 0.6071138 0.6548949 0.6767109 0.3129101 0.2382516
##  [235] 0.7950347 0.2921330 0.7001001 0.7552874 0.5482412 0.2527719
##  [241] 0.5616947 0.3973446 0.6009929 0.4437342 0.2900042 0.5483554
##  [247] 0.7276250 0.6494833 0.8735304 0.8215692 0.1833596 0.7617788
##  [253] 0.7433743 0.5755587 0.5050841 0.7340966 0.3702915 0.6416838
##  [259] 0.7877062 0.8603593 0.6749283 0.5521709 0.3647131 0.4690301
##  [265] 0.7198751 0.2050465 0.3427966 0.6443202 0.3205100 0.7012261
##  [271] 0.6637167 0.8946819 0.7047466 0.7870986 0.7291922 0.3982687
##  [277] 0.4893562 0.6673005 0.4795379 0.4753981 0.3610867 0.5745391
##  [283] 0.5991248 0.8296156 0.6341979 0.6529083 0.8453724 0.1059304
##  [289] 0.5000398 0.7973194 0.4237556 0.4654970 0.3401058 0.5897025
##  [295] 0.8619721 0.5974473 0.2432224 0.4598553 0.8739689 0.8459948
##  [301] 0.9937034 0.7001163 0.7632933 0.9526626 0.1276148 0.7024508
##  [307] 0.4994390 0.5747054 0.7781712 0.8145786 0.3118645 0.6568942
##  [313] 0.7666653 0.3792475 0.4462099 0.8260736 0.6472698 0.5079964
##  [319] 0.5973720 0.8899534 0.6014966 0.5766270 0.8273570 0.4238601
##  [325] 0.6832784 0.6545202 0.7550287 0.5616365 0.3619394 0.5135111
##  [331] 0.8862686 0.9629033 0.6393706 0.5126028 0.5247622 0.5158008
##  [337] 0.4021001 0.8156497 0.8693056 0.8066716 0.2902849 0.7515321
##  [343] 0.4015355 0.6420753 0.3102849 0.8292753 0.7797479 0.6336303
##  [349] 0.4146340 0.4067755 0.2315140 0.6988056 0.6708261 0.5772693
##  [355] 0.4882733 0.6282683 0.6537070 0.6415639 0.5198622 0.6430661
##  [361] 0.6168901 0.8288806 0.4915884 0.5942977 0.8234563 0.6060817
##  [367] 0.9023210 0.3536230 0.5457570 0.6249949 0.1405489 0.3351785
##  [373] 0.7998244 0.3871313 0.8280747 0.4174268 0.6394403 0.4565584
##  [379] 0.8254494 0.6827649 0.6225789 0.6909425 0.6217688 0.6862152
##  [385] 0.2361094 0.7261384 0.4356802 0.9093708 0.7649482 0.8624918
##  [391] 0.2612941 0.7468636 0.7255278 0.6256923 0.7061332 0.5230234
##  [397] 0.4953551 0.4617066 0.4640720 0.9241750 0.9558649 0.5810160
##  [403] 0.4299361 0.8750297 0.6546782 0.5987363 0.2848178 0.9174146
##  [409] 0.9471959 0.5199397 0.4197631 0.4513136 0.2659200 0.5022622
##  [415] 0.4121484 0.5208099 0.7449541 0.8383439 0.6284578 0.8859483
##  [421] 0.8507900 0.5654403 0.8021159 0.3457601 0.6928032 0.5330027
##  [427] 0.7286449 0.7952814 0.3693643 0.7004136 0.3704988 0.8450405
##  [433] 0.3331144 0.5427255 0.9035762 0.5274749 0.5814293 0.6131727
##  [439] 0.9268892 0.5643804 0.7699296 0.6799955 0.5900743 0.3434277
##  [445] 0.8081505 0.6566343 0.2775134 0.4304973 0.5724703 0.4547545
##  [451] 0.8730144 0.3434147 0.9408149 0.3065626 0.4396844 0.9584674
##  [457] 0.8021842 0.7043386 0.3584534 0.5537358 0.8483352 0.5694514
##  [463] 0.8741474 0.5052444 0.2925864 0.7945013 0.5132128 0.8410654
##  [469] 0.5805797 0.5639059 0.5063430 0.4945947 0.5524168 0.9197021
##  [475] 0.5568993 0.1689937 0.5494763 0.3000321 0.2090155 0.5761833
##  [481] 0.3983769 0.2754890 0.9302272 0.8632941 0.5379474 0.6864164
##  [487] 0.7646039 0.4226586 0.3643656 0.7101420 0.4459542 0.8668679
##  [493] 0.6794115 0.9949265 0.7157371 0.3087902 0.6040370 0.5757795
##  [499] 0.2679352 0.7372490 0.1892483 0.6525209 0.4080584 0.3761740
##  [505] 0.9496998 0.6410692 0.4853107 0.3122968 0.1882234 0.7131163
##  [511] 0.7434343 0.1883706 0.6070630 0.5289546 0.2502775 0.7808123
##  [517] 0.7988189 0.5089331 0.2172808 0.8883070 0.3463059 0.5081681
##  [523] 0.5908329 0.7580142 0.6973613 0.9211733 0.3679731 0.5136816
##  [529] 0.4251316 0.6084737 0.8067703 0.6608275 0.6207050 0.4540509
##  [535] 0.7315361 0.5425802 0.9429281 0.7037397 0.8590489 0.6488350
##  [541] 0.8097702 0.6704413 0.6171054 0.7115075 0.2097513 0.5690593
##  [547] 0.5131739 0.5223765 0.4641012 0.3666267 0.9205885 0.5188695
##  [553] 0.6657057 0.1824237 0.8234633 0.1543779 0.4696918 0.8055435
##  [559] 0.8621069 0.7932981 0.6701154 0.5877944 0.8740771 0.4819065
##  [565] 0.8596997 0.3353438 0.8212774 0.5663820 0.6058280 0.7098656
##  [571] 0.7098105 0.5652967 0.9419890 0.3597769 0.5672882 0.5076524
##  [577] 0.9127553 0.6605664 0.6522831 0.4986497 0.7552532 0.5085828
##  [583] 0.4069826 0.6928409 0.7730337 0.2474645 0.8156305 0.7085481
##  [589] 0.5785680 0.8689332 0.6126520 0.8955000 0.6555809 0.7716728
##  [595] 0.7684879 0.5937982 0.2676743 0.1827702 0.6404586 0.7466639
##  [601] 0.3322718 0.6801763 0.6084855 0.1848069 0.3703001 0.5306869
##  [607] 0.3070564 0.4293745 0.6863493 0.6950378 0.4691551 0.6310538
##  [613] 0.6635740 0.7348664 0.6879090 0.8227951 0.3628328 0.9137842
##  [619] 0.2636411 0.5010985 0.7599746 0.8066794 0.3952758 0.4840394
##  [625] 0.7010009 0.5053962 0.4677463 0.5444834 0.3372915 0.5730411
##  [631] 0.8975170 0.6417591 0.8082465 0.7112428 0.6004664 0.3523187
##  [637] 0.7968133 0.8131652 0.2682550 0.2737044 0.3993360 0.3156950
##  [643] 0.5588463 0.7344284 0.8187034 0.8100318 0.7371159 0.8555109
##  [649] 0.8961085 0.7964806 0.7497847 0.8553482 0.5597935 0.6565674
##  [655] 0.5027437 0.6853646 0.7724451 0.9180890 0.6621154 0.6167859
##  [661] 0.7504010 0.3698070 0.7468532 0.7510100 0.5672085 0.7958586
##  [667] 0.4812683 0.5231344 0.8429081 0.1912571 0.4294929 0.4828256
##  [673] 0.4812119 0.7021959 0.4810106 0.6734636 0.1741130 0.1157346
##  [679] 0.8007245 0.3854258 0.7138677 0.2832533 0.5075079 0.7225948
##  [685] 0.7461950 0.5512295 0.8938038 0.5349004 0.3583330 0.3269762
##  [691] 0.6024072 0.5763075 0.7738873 0.9657601 0.8212419 0.4239351
##  [697] 0.4734350 0.7586296 0.7437370 0.6895932 0.4664835 0.6909845
##  [703] 0.6054551 0.5480467 0.3786275 0.5299231 0.9485705 0.8335421
##  [709] 0.2340297 0.6430373 0.3169562 0.6658679 0.1772238 0.4341346
##  [715] 0.2029398 0.7611798 0.2298445 0.7397916 0.4657478 0.4877046
##  [721] 0.5129809 0.7491113 0.4202463 0.8442325 0.4318132 0.2199435
##  [727] 0.4064468 0.4259130 0.7112674 0.6015331 0.7689221 0.7003173
##  [733] 0.4843247 0.4664102 0.6762592 0.7877079 0.5313364 0.4363104
##  [739] 0.9154659 0.9071040 0.9403903 0.4919494 0.7877928 0.6786279
##  [745] 0.7520513 0.4462550 0.5835234 0.7494155 0.9196860 0.5969355
##  [751] 0.6128906 0.7432495 0.5158575 0.6590162 0.4011781 0.6385179
##  [757] 0.6872102 0.8261931 0.5490941 0.6464148 0.8209569 0.7890915
##  [763] 0.5187473 0.4405102 0.4257979 0.8451440 0.3339131 0.2783366
##  [769] 0.1935078 0.9176419 0.9157377 0.2826262 0.2066532 0.4824517
##  [775] 0.8675402 0.3149698 0.3937202 0.8123348 0.4057750 0.7045849
##  [781] 0.6383894 0.2893165 0.6302119 0.5110721 0.4974181 0.8554259
##  [787] 0.7290611 0.5536944 0.6510726 0.5296594 0.3525172 0.8852510
##  [793] 0.6909113 0.6751687 0.8155430 0.2515895 0.7400353 0.8633507
##  [799] 0.9371337 0.5361521 0.8583738 0.6188278 0.6299166 0.6027861
##  [805] 0.6261619 0.2372624 0.4669218 0.7057139 0.4888448 0.5878208
##  [811] 0.5284991 0.5146837 0.4643168 0.7106677 0.2766725 0.5512023
##  [817] 0.7402380 0.8543363 0.4104424 0.5405652 0.8159995 0.6258077
##  [823] 0.7717085 0.4350757 0.3597471 0.8117091 0.6911193 0.4907901
##  [829] 0.5856059 0.7096246 0.5108656 0.6444015 0.1779935 0.5342186
##  [835] 0.1391430 0.4950985 0.6679712 0.6037411 0.8020499 0.3149766
##  [841] 0.5790403 0.4432096 0.7263289 0.7776943 0.7354018 0.3241734
##  [847] 0.4791963 0.2878188 0.8681952 0.5461122 0.2590376 0.9464858
##  [853] 0.3338117 0.7129285 0.3843526 0.4177769 0.8035243 0.9106746
##  [859] 0.5350988 0.2564678 0.4931557 0.7568322 0.6000545 0.7747692
##  [865] 0.6617136 0.8886773 0.7440262 0.7222453 0.5666731 0.5975384
##  [871] 0.7843910 0.6153477 0.6194842 0.7836433 0.5516440 0.5531824
##  [877] 0.9409439 0.4367286 0.2726208 0.7697767 0.5864475 0.8054582
##  [883] 0.8727889 0.4980855 0.5087478 0.4956335 0.4497536 0.8978887
##  [889] 0.8830534 0.6399267 0.5163420 0.7160558 0.7289977 0.4592376
##  [895] 0.5536149 0.3918265 0.6593121 0.3198693 0.1786922 0.5139580
##  [901] 0.6969339 0.4856741 0.7703820 0.5362865 0.7961043 0.7569851
##  [907] 0.6961293 0.6657331 0.8920746 0.3357073 0.5431715 0.5964449
##  [913] 0.5971916 0.8364476 0.5771787 0.5205851 0.4690658 0.5116233
##  [919] 0.4319721 0.7220383 0.5074730 0.9822353 0.6294500 0.6628307
##  [925] 0.7142088 0.1601048 0.7094119 0.3986928 0.6400243 0.8295302
##  [931] 0.5180705 0.4454798 0.8876281 0.5777529 0.7922298 0.7167281
##  [937] 0.8738033 0.7237436 0.5640605 0.5595020 0.5911539 0.8483405
##  [943] 0.8142896 0.5019248 0.4418632 0.6858553 0.4816186 0.5999302
##  [949] 0.3610329 0.6814613 0.7314317 0.8958578 0.8925237 0.5182765
##  [955] 0.6965135 0.3492467 0.4097193 0.7840244 0.4353421 0.8522670
##  [961] 0.2909569 0.9616422 0.4685285 0.4092333 0.7235272 0.7094310
##  [967] 0.9147416 0.4288538 0.4111475 0.6541778 0.3578069 0.5665756
##  [973] 0.4638009 0.7958304 0.5798663 0.5225826 0.3954381 0.4918140
##  [979] 0.5819612 0.4743187 0.8199309 0.7158299 0.2776632 0.4354346
##  [985] 0.6531503 0.4489344 0.7666186 0.4724603 0.9607500 0.3244758
##  [991] 0.4618674 0.5505571 0.3844975 0.6432977 0.5399965 0.7738420
##  [997] 0.7105733 0.4534381 0.5484010 0.5304928</code></pre>
<p>The histogram of the sample is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Graph the histogram</span>
<span class="kw">hist</span>(a,<span class="dt">probability =</span> <span class="ot">TRUE</span> , <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">^</span>(<span class="dv">3</span><span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">^</span>(<span class="dv">2</span><span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="kw">beta</span>(<span class="dv">3</span>,<span class="dv">2</span>)))
x=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)
<span class="kw">lines</span>(x,x<span class="op">^</span>(<span class="dv">3</span><span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">^</span>(<span class="dv">2</span><span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="kw">beta</span>(<span class="dv">3</span>,<span class="dv">2</span>))</code></pre></div>
<p><img src="data:image/png;base64,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/ryUebF6ecq81LC6KUhBGc+9WE1wg6NkMbLxYjXBzQUA8lisJri5BEB4sZrg5iIARYsApbshQMlRCNAaRghQhigJ0a9PBAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBLQsoEba0opfdIy5nCYbOe3vWewLc/cfj1diGv+tthYF1O0pM+wrc3xqP9QRhZONnJrbl5PnixvmOuzGS1WKSaAlAYnLRP12MmLfnfCtUxQj4kvU/ittpRmSKSaRlgRkYOJ73CxG9h/F7kHXsIfxYmfQsVoUEC+OchE2fON8xUjz6p+76LcwToD0fNm1JCBRXeRKE3HTg2Kk7ppJ5MtRJiJ6vhxaFVAT2UdPgG4Cjr1mqThA86ocddOMYkT0G5H7rJXXxGadYdwOe4oRUajIrrq8TlodTiN3iVWMiBtwUptYMcO8MiHb38cOPvKsrrvtRroLJ8xQcRPFrtbwKX037tTivpCIzXQlI3y+lzTMCyt1IUuNSxABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCg4gFVjKW9nztRpQPq7gOrE9/QnaTCAR3ePCe/HDdNhQPq1GzaxkoHVDP26u9Ug6zirYuamF38xsuGmphVXeU57Lbc1rJwQOKG3WrDcb50QJuLAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBA/wc6y8vyJ7ZB3QAAAABJRU5ErkJggg==" /><!-- --></p>
<p>The histogram of the sample is similar the theoretical Beta(3,2). It is reasonable.</p>
<p>3.12</p>
<p>I will generate 1000 random obserbations from thie mixture <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span> . First generate the rate parameter, then generate random observations.</p>
<p>Generate the rate parameter, then generate random observations:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">r=<span class="dv">4</span>;
beta=<span class="dv">2</span>;
<span class="co"># n is the number of random observations</span>
n=<span class="dv">1000</span>;
<span class="co"># generate a from gamma distribution</span>
a=<span class="kw">rgamma</span>(n,r,beta)
<span class="co"># generate x from exp distribution</span>
x=<span class="kw">rexp</span>(n,a)
<span class="co"># print random observations</span>
x</code></pre></div>
<pre><code>##    [1] 6.466707e-01 2.322308e+00 5.585475e-01 1.999282e+00 1.134586e+00
##    [6] 1.352588e+00 1.709565e+00 2.105008e-02 1.488316e-01 1.013900e+00
##   [11] 2.583744e-01 4.859855e-01 2.244814e-01 6.225886e-01 1.931817e-01
##   [16] 5.507652e-01 8.886473e-01 1.336041e+00 5.732741e-02 3.278172e-01
##   [21] 2.073416e-01 1.219196e+00 1.152002e-02 3.723210e-01 9.493069e-02
##   [26] 4.421617e-01 5.316183e-02 4.126236e-01 8.679736e-01 7.006135e-02
##   [31] 9.029525e-01 9.019400e-01 4.966450e-01 5.768311e-02 2.087622e-01
##   [36] 2.228901e-02 2.367155e+00 1.155944e+00 2.569432e-01 2.462173e-02
##   [41] 2.267576e-01 1.362144e-01 2.882909e-04 4.387852e+00 1.921157e-01
##   [46] 3.088763e+00 8.871947e-02 2.838922e-01 4.621641e-01 7.359271e-01
##   [51] 1.710420e-01 3.887325e-01 6.892069e-01 3.143757e-01 4.384441e-01
##   [56] 1.403606e+00 5.018551e-01 5.793581e-01 5.007305e-01 1.385235e+00
##   [61] 4.102583e+00 8.698929e-01 9.841299e-02 1.961120e+00 2.221057e-01
##   [66] 2.038378e+00 6.728311e-02 2.796437e-02 5.581762e-02 7.675886e-01
##   [71] 6.150326e-01 3.837945e-01 4.482316e-01 1.917176e-02 2.536241e-01
##   [76] 1.326943e+00 1.064665e-01 1.046241e-01 4.189576e-02 2.165549e-01
##   [81] 2.608246e+00 1.400574e-01 2.103001e-01 1.373417e+00 5.004288e-02
##   [86] 3.480244e-01 3.618894e-01 1.917288e+00 3.094912e-01 6.520257e-01
##   [91] 4.062074e-01 4.554293e-01 2.316805e-01 6.065130e-01 2.735472e-01
##   [96] 1.970228e-01 2.487732e-03 1.713163e+00 4.105250e-02 8.148229e-01
##  [101] 2.429700e-01 7.599472e-02 5.233209e-01 4.011215e-01 3.870917e-02
##  [106] 6.173760e+00 5.486254e-02 1.041605e-02 7.333792e-02 5.119914e-02
##  [111] 1.655427e+00 2.939170e-01 1.200252e-01 2.282058e-02 1.745248e-01
##  [116] 5.557370e-03 3.304824e-01 1.073579e+00 1.780774e-01 3.757616e-01
##  [121] 7.849487e-01 3.322136e-01 1.320972e+00 8.861088e-02 1.433452e+00
##  [126] 7.296091e-01 1.081915e+00 1.957733e+00 3.427549e-01 1.450920e+00
##  [131] 9.114118e-01 3.485083e-01 1.454030e+00 2.862461e-01 3.811269e-02
##  [136] 2.280970e+00 1.974528e-01 6.771665e-01 3.577151e-01 4.022327e-03
##  [141] 5.662112e-01 7.652237e-01 7.350758e-02 1.836076e+00 1.112092e+00
##  [146] 1.794652e-02 2.763125e-01 2.155163e-01 2.236115e-01 5.284869e-01
##  [151] 3.421368e+00 6.189283e-01 1.389851e-01 7.192739e-01 3.459940e-01
##  [156] 3.766272e-01 8.039388e-04 1.091041e-01 4.175556e-01 5.790646e-01
##  [161] 7.368065e-01 5.012778e-01 1.502407e-01 3.393160e-03 8.410289e-01
##  [166] 6.332715e-01 1.385287e+00 6.135802e-01 1.048748e-01 3.754809e-01
##  [171] 3.627891e-01 1.282322e-01 5.840333e-01 2.338776e+00 2.222668e+00
##  [176] 7.488018e-01 9.825050e-01 3.073132e-02 1.167368e+00 2.904124e+00
##  [181] 3.093641e-01 6.382268e-02 3.126233e-01 2.072504e-02 2.380012e-02
##  [186] 2.236776e-01 7.576537e-01 3.594550e-02 3.304542e+00 3.979116e-01
##  [191] 2.361142e-01 1.336030e-01 5.265624e-01 2.178363e-01 9.697439e-01
##  [196] 3.224612e-01 2.570811e+00 2.060359e-01 2.390597e+00 2.127467e-02
##  [201] 1.385000e-01 1.549336e-01 1.826258e-01 1.741443e-01 1.300645e-01
##  [206] 8.061378e-01 4.338424e-01 8.633717e-02 9.861084e-02 1.231216e-01
##  [211] 2.714094e-01 7.821321e-01 1.786462e-01 4.764558e-02 2.224083e-01
##  [216] 1.164007e-01 1.123988e+00 8.127489e-01 2.561419e-01 8.903115e-01
##  [221] 2.547258e-01 1.135934e-01 6.778493e-01 1.904570e-01 4.281893e-01
##  [226] 6.769763e-01 6.981007e-01 3.822973e-01 2.612428e-01 7.754755e-02
##  [231] 1.780424e-01 5.067035e-01 2.842632e-01 1.931560e-01 9.223882e-01
##  [236] 4.765303e-01 8.340927e-01 8.846460e-01 3.674060e-01 6.579398e-01
##  [241] 5.170176e-01 8.373198e-01 3.125214e-01 5.008226e-02 9.631542e-01
##  [246] 1.538800e-01 3.785043e-01 8.114838e-03 8.776547e-02 3.824880e-01
##  [251] 1.999393e+00 1.572025e-01 7.477494e-03 1.964632e-01 2.879251e-01
##  [256] 5.649427e-01 6.477501e-01 1.781845e-01 2.627454e+00 7.062026e-01
##  [261] 6.431331e-01 2.131930e-01 2.309649e-01 1.488453e-01 3.164401e-02
##  [266] 9.705445e-02 3.213693e-02 2.130997e-01 7.541266e-01 3.115563e-01
##  [271] 8.287835e-01 2.901464e-02 1.719495e+00 5.397125e-01 1.390264e-01
##  [276] 1.097109e+00 8.613263e-01 1.111704e-01 3.116034e-01 7.622805e-01
##  [281] 5.710708e-02 5.443620e-01 1.179297e-01 3.793814e-01 5.764345e-01
##  [286] 1.218702e-01 1.514931e+00 2.374709e-01 2.056605e+00 6.647428e-01
##  [291] 3.365401e-01 3.059847e-02 1.597072e+00 7.298178e-01 4.851160e-01
##  [296] 3.965449e-01 2.036507e-01 3.847325e+00 5.201848e-01 4.793102e-01
##  [301] 2.837238e-01 6.508826e-01 3.733917e-01 3.157559e-01 3.336349e-01
##  [306] 1.135035e+00 2.910297e-01 1.039883e+00 6.038707e-01 1.008961e-02
##  [311] 4.887166e+00 1.093668e+00 1.331285e+00 1.130673e+00 8.398725e-01
##  [316] 8.888137e-01 2.183557e-01 3.385808e-01 2.567733e-02 4.934868e-02
##  [321] 7.520985e-01 5.219993e-01 7.171272e-01 1.785025e-01 5.915333e-01
##  [326] 3.872159e-02 1.128896e-01 1.436772e+00 5.009746e-01 1.574684e+00
##  [331] 3.369875e-01 6.275571e-01 3.522868e-03 3.155775e-01 9.731785e-02
##  [336] 9.431448e-01 1.009038e-01 1.022886e+00 1.345777e+00 1.750735e+00
##  [341] 1.170794e-01 1.618642e-02 7.292133e-01 4.597475e-02 3.262541e-01
##  [346] 6.429113e-01 1.152053e+00 1.570777e+00 2.612890e-01 1.856209e-01
##  [351] 1.376733e+00 2.809147e-01 6.394173e-01 1.002057e-01 2.094859e-01
##  [356] 3.737599e-01 1.234865e+00 7.428855e-02 4.757678e-02 6.710548e-01
##  [361] 2.388225e+00 1.655410e-02 1.114952e-01 1.380430e-01 3.054922e-01
##  [366] 4.200242e-01 5.374110e-01 3.090956e-01 8.609622e-01 5.130852e-02
##  [371] 2.238645e-01 7.864878e-01 4.320450e-02 1.840027e-02 2.925066e-01
##  [376] 6.383046e-01 3.831869e-01 1.330781e-01 7.429228e-02 8.073057e-01
##  [381] 5.765563e-01 4.746281e-01 7.175730e-02 7.992096e-02 1.178166e+00
##  [386] 1.825149e-02 1.255175e+00 1.404435e-01 7.836180e-01 1.495977e+00
##  [391] 1.187807e-01 1.634377e+00 3.526774e-01 4.717930e-01 6.616915e-02
##  [396] 4.019382e-01 1.852785e-01 1.352293e+00 1.248251e+00 1.569409e-01
##  [401] 4.375523e-01 2.537412e-01 3.111163e-01 1.322122e+00 2.194507e+00
##  [406] 1.092294e-01 1.981028e-01 3.980850e-01 9.840515e+00 1.261586e+00
##  [411] 4.599152e-01 7.025500e-01 2.873101e+00 2.106337e+00 2.364824e+00
##  [416] 1.126414e+00 3.797440e-01 2.994191e-01 5.142207e-02 8.489164e-01
##  [421] 5.419459e-01 1.102270e-01 1.089141e+00 3.702024e-01 1.792848e-01
##  [426] 2.819541e-01 8.663929e-01 8.359502e+00 1.070482e+00 1.655761e-01
##  [431] 1.001957e+00 8.531536e-01 3.054119e-01 2.544228e-01 1.718764e-01
##  [436] 1.285405e-01 1.599787e-01 4.505556e-01 1.941294e-01 7.192427e-01
##  [441] 3.297978e-02 8.310005e-03 3.594739e-01 4.834129e-01 3.489446e-01
##  [446] 3.267216e-01 1.305350e-02 2.527051e-01 1.082476e+00 6.619080e-01
##  [451] 1.476866e+00 1.802926e-01 3.487250e-01 2.168621e-02 5.009355e-01
##  [456] 1.512778e+00 9.695992e-02 1.618946e+00 5.141930e-02 2.500189e-01
##  [461] 2.989293e+00 4.140865e-01 3.669437e-01 1.421597e+00 3.982768e-01
##  [466] 2.612657e+00 8.505225e-02 4.039142e-01 2.865316e-01 1.657796e+00
##  [471] 1.801485e-01 5.455317e-01 5.723470e-01 5.627292e-01 3.984706e-01
##  [476] 6.956824e-01 1.880271e-01 6.868154e-02 8.578267e-01 1.066957e-01
##  [481] 1.059513e+00 1.160018e+00 3.829263e-01 2.741118e-01 4.641935e-01
##  [486] 4.224679e-01 3.876838e-02 2.577244e-01 1.191973e-01 8.457619e-02
##  [491] 2.339531e+00 1.630071e+00 2.597270e-01 5.199907e-02 4.412272e-01
##  [496] 1.180541e-01 1.338346e+00 5.444486e-01 1.321643e+00 1.085779e-01
##  [501] 4.967716e-01 1.209253e+00 2.473061e+00 9.248513e-02 6.238038e+00
##  [506] 3.082409e-01 2.368947e-01 1.012619e+00 3.982949e-01 1.100223e+00
##  [511] 1.096172e-01 3.261343e-01 1.063755e+00 9.447482e-02 1.164578e+00
##  [516] 2.691845e-01 1.830946e+00 8.855295e-01 5.390695e-01 1.455816e-02
##  [521] 5.289856e-01 2.322231e-01 8.249658e-02 2.650796e-01 1.827671e-02
##  [526] 1.064514e-02 2.972228e+00 1.830196e-01 1.203863e-01 5.845966e-02
##  [531] 1.104950e-01 1.943946e-01 1.112592e+00 1.976255e-01 3.296819e-01
##  [536] 3.136360e-01 6.647931e-01 2.035680e-01 3.654421e-02 3.600149e-01
##  [541] 1.049044e-01 3.182251e-01 2.152865e+00 1.668287e-01 8.236219e-01
##  [546] 3.881122e-01 5.299185e-02 1.316402e-01 2.601922e-01 2.540275e-01
##  [551] 6.351342e-01 5.861005e-01 1.065274e+00 1.027124e-01 1.466353e+00
##  [556] 4.132486e-01 9.582387e-01 9.761572e-01 3.396455e-01 6.256641e-01
##  [561] 1.323944e-01 5.752623e-02 2.857498e-01 8.228118e-01 1.559394e-01
##  [566] 4.286950e-01 3.169590e-01 5.150958e-01 1.535923e+00 9.097165e-03
##  [571] 2.792078e-01 2.792470e-01 3.487133e-01 1.318114e+00 1.035543e+00
##  [576] 1.550415e+00 9.317503e-01 2.349448e+00 3.488639e-01 3.249710e-01
##  [581] 3.793981e-02 8.196558e-01 1.136916e-01 1.364081e-01 3.195531e-01
##  [586] 2.421856e+00 2.602567e-01 1.820969e+00 7.048796e-01 8.101052e-01
##  [591] 1.270804e-01 3.140410e-01 3.893717e-01 4.021587e-01 3.436824e-01
##  [596] 3.327396e-01 1.037712e-02 3.088701e-01 4.013429e-01 6.676993e-02
##  [601] 1.356551e+00 2.327786e+00 1.251973e-01 4.251813e-01 3.020195e-01
##  [606] 1.405748e+00 9.596200e-01 2.235012e+00 4.349351e-01 1.766669e+00
##  [611] 2.668885e-02 4.866155e-02 1.700824e-01 4.823114e-01 1.690133e-01
##  [616] 1.495425e+00 4.260924e-01 1.807999e-01 1.589173e-01 2.091043e-01
##  [621] 4.140423e-01 7.490585e-02 3.961587e-02 2.459026e-01 5.490000e-01
##  [626] 9.597090e-03 1.169366e+00 8.426733e-01 2.440760e-01 2.133310e-02
##  [631] 2.258497e-01 6.011590e-01 2.719185e+00 4.439434e-01 3.444262e-02
##  [636] 7.625689e-01 9.080488e-02 3.068741e+00 3.359783e-02 2.076374e+00
##  [641] 8.419913e-01 1.560939e-01 4.825489e-01 7.990033e-01 1.444743e+00
##  [646] 2.568996e+00 3.251993e-01 2.068869e-01 2.900940e-01 2.032641e-01
##  [651] 9.474876e-01 1.899127e+00 8.124665e-02 4.207993e+00 3.128746e+00
##  [656] 2.319341e-01 2.035015e-02 1.207068e-01 5.472224e-01 1.893774e+00
##  [661] 7.569757e-02 5.531933e-01 4.034413e-01 1.674917e+00 1.743417e+00
##  [666] 9.294187e-01 1.481513e-01 4.454196e-01 1.241308e+00 7.420539e-01
##  [671] 2.530341e-01 5.903643e-01 6.483047e-02 1.187817e-01 3.589910e-01
##  [676] 3.337227e-01 7.687227e-02 4.847944e-01 1.754313e-01 1.167043e+00
##  [681] 8.680353e-01 3.836321e-01 2.216356e-01 2.472810e-02 7.489555e-01
##  [686] 8.713243e-02 9.729280e-02 1.047570e+01 1.567337e-01 2.964141e-01
##  [691] 3.374936e-01 3.774296e-03 5.794581e-01 4.139420e-01 1.556343e+00
##  [696] 3.847773e-01 3.185398e-02 1.510629e-01 6.858684e-01 1.508966e+00
##  [701] 2.875305e+00 2.342834e-01 9.797711e-01 6.809143e-02 1.926730e-01
##  [706] 4.872050e-01 1.714575e-01 1.594928e-01 1.748243e+00 7.043503e-01
##  [711] 4.348821e-01 1.111043e+00 1.200600e+00 1.735294e-01 7.146011e-01
##  [716] 1.989340e-01 2.812722e-01 3.098663e-01 2.636502e-02 1.633103e+00
##  [721] 1.825142e-01 8.133336e-01 5.399393e-02 4.836176e-01 9.936975e-02
##  [726] 1.694109e-01 6.179201e-02 7.909700e-01 4.924366e-01 2.582005e-01
##  [731] 3.374215e-01 2.044166e-01 5.022667e-01 5.690245e-03 2.960670e+00
##  [736] 6.614048e-01 4.857588e-01 1.575608e-01 1.182076e-01 1.598678e+00
##  [741] 1.549788e-01 2.988738e-01 7.207651e-01 1.014603e-01 1.086944e+00
##  [746] 6.708398e-01 4.979653e-02 1.411555e-01 3.041771e-01 5.675457e-01
##  [751] 1.075861e+00 4.485764e-01 3.266046e-02 6.222130e-02 1.037470e+00
##  [756] 1.364340e+00 7.112831e-01 1.466294e+00 1.798114e-01 5.103170e-01
##  [761] 5.265030e-02 4.751042e-01 3.425299e-01 5.427767e-01 6.215256e+00
##  [766] 8.784222e-02 1.714810e-01 1.748343e+00 6.421724e-01 3.067723e-01
##  [771] 1.442795e+00 2.542619e-01 1.085364e-01 2.320486e-01 4.135552e-02
##  [776] 1.502857e+00 4.943282e+00 3.844921e-01 6.547334e-02 5.051097e-01
##  [781] 2.051009e-01 8.640145e-01 1.295533e+00 7.515110e-01 3.652407e-01
##  [786] 6.776618e-01 1.178370e+00 2.382700e+00 7.874438e-01 1.071915e-01
##  [791] 4.569407e-01 1.567653e-01 2.116860e-01 2.414024e-01 1.316459e+00
##  [796] 7.145810e-01 2.960208e-01 9.616053e-01 1.127063e+00 5.273412e-01
##  [801] 7.483509e-02 1.628283e-01 2.557249e-01 1.471270e-01 8.340349e-02
##  [806] 1.660924e-01 5.185358e-02 3.325402e-01 1.576682e-01 2.228871e-01
##  [811] 1.036040e+00 6.109796e-02 5.065178e-01 6.015735e-01 1.322667e-02
##  [816] 3.757627e+00 3.535373e+00 5.039443e-02 6.023272e-02 8.905401e-02
##  [821] 1.233765e-01 1.957746e-01 1.338457e-02 6.551680e-01 5.305006e-01
##  [826] 1.370604e+00 2.642161e-01 2.704147e+00 1.436129e-01 4.369182e-01
##  [831] 1.216118e-01 5.011897e-01 5.203153e-01 2.486902e-01 1.294750e-01
##  [836] 6.114441e-01 4.590370e-02 9.032451e-01 1.956597e+00 3.351162e-03
##  [841] 3.973739e-01 1.466512e+00 8.998102e-02 9.798679e-01 4.922841e-02
##  [846] 7.661988e-02 3.877889e+00 6.091742e-01 5.846955e-01 1.031831e-01
##  [851] 3.240012e-01 1.166929e+00 2.077275e-01 4.871839e-01 4.244237e-01
##  [856] 4.163729e-01 2.847551e-01 2.939763e-01 5.981775e-02 5.207320e-01
##  [861] 1.158169e-01 4.510892e-02 4.659988e-01 2.016934e-01 1.500217e+00
##  [866] 1.726862e+00 1.148904e+00 1.067484e+00 4.989874e-03 1.845873e-01
##  [871] 2.586859e-01 5.454790e-02 2.563646e+00 6.093473e-01 2.909913e-01
##  [876] 1.334832e-01 9.379713e-02 3.474706e-01 7.261514e-01 2.220513e-01
##  [881] 2.813291e-01 5.138726e-01 3.660684e+00 4.743105e-01 9.427794e-02
##  [886] 1.012877e-01 6.201573e-01 1.142352e-01 2.763453e+00 8.532189e-02
##  [891] 5.346502e-01 4.517328e-01 5.600112e-02 1.697254e-01 1.135831e+00
##  [896] 2.247006e-01 6.801431e-01 2.566126e-01 2.039864e-01 7.029044e-01
##  [901] 1.725430e+00 7.465715e-02 3.640785e-01 3.628748e-01 4.448285e-01
##  [906] 2.379753e+00 1.245748e-01 3.239554e-01 1.015715e+00 1.028503e-01
##  [911] 1.069291e+00 1.602794e-01 2.733222e-01 6.251309e-01 7.380145e-01
##  [916] 1.594774e-01 1.647172e-01 1.539229e-01 1.047135e-01 8.123709e-01
##  [921] 2.397382e-01 5.707148e-02 8.052383e-02 1.587623e-01 1.577599e-03
##  [926] 6.092758e-01 8.836870e-01 2.461196e+00 6.050523e-01 8.743222e-01
##  [931] 6.022762e-02 1.495054e-01 2.365016e+00 5.097295e-01 8.339103e-02
##  [936] 1.138770e+00 4.279319e-01 1.068141e-01 1.499186e+00 6.301643e-02
##  [941] 2.329804e-01 1.702154e+00 2.193831e-01 1.068349e-01 1.498927e+00
##  [946] 1.863722e-01 2.416132e-01 2.024401e+00 5.964527e-01 5.857136e-01
##  [951] 3.323610e-01 1.001684e-01 2.438093e+00 9.648847e-01 3.142364e-01
##  [956] 3.374226e-01 3.365506e-02 3.999613e-01 1.667483e+00 9.901428e-02
##  [961] 3.787653e-03 1.852954e-01 2.108744e-01 6.498126e-02 2.630648e+00
##  [966] 3.532222e+00 4.980185e-01 2.640696e-01 1.393306e-01 1.831191e-01
##  [971] 4.638959e-02 2.651065e-01 3.471824e+00 8.049587e-01 3.555343e-01
##  [976] 7.798675e-01 1.477095e-01 4.689079e-01 7.018271e-01 8.279799e-02
##  [981] 5.245229e-01 1.856972e+00 3.428528e-01 5.205549e-02 6.370067e-02
##  [986] 1.284593e-01 7.642641e-01 1.741740e-01 7.720783e-01 1.756791e-03
##  [991] 8.090899e-02 4.027884e-01 7.741647e-02 7.878737e-01 1.997015e-01
##  [996] 9.491798e-01 8.627216e-03 4.337680e-01 2.403378e-01 8.972910e-01</code></pre>
<p>the histogram of it is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(x,<span class="dt">probability =</span> <span class="ot">TRUE</span> )</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It is good.</p>
<p>thank you for reading</p>
</div>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>5.4</p>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3, 3) cdf, and use the function to estimate <span class="math inline">\(F(x)\)</span> for x = 0.1, 0.2, . . . , 0.9. Compare the estimates with the values returned by the<span class="math inline">\(pbeta\)</span> function in R.</p>
</div>
<div id="answer-1-1" class="section level2">
<h2>Answer 1</h2>
<p>5.4</p>
<p>“cdf” means Cumulative Distribution Function.</p>
<p>First, write the function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">12345</span>)
cdf.beta=<span class="cf">function</span>(x){
  n=<span class="fl">1e4</span>
  t=<span class="kw">runif</span>(n,<span class="dv">0</span>,x)
  a=<span class="kw">mean</span>(t<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>t)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">beta</span>(<span class="dv">3</span>,<span class="dv">3</span>))<span class="op">*</span>x <span class="co">#Use a frequency to approximation the expectation</span>
  <span class="kw">return</span>(a)
}</code></pre></div>
<p>Draw the estimate function and <span class="math inline">\(Beta(3,3)\)</span> cdf</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">1</span>)
y1=<span class="kw">numeric</span>(<span class="dv">10</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">1</span>)){
  y1[i<span class="op">*</span><span class="dv">10</span><span class="op">+</span><span class="dv">1</span>]=<span class="kw">cdf.beta</span>(i)
}
y2=<span class="kw">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)
<span class="kw">plot</span>(x,y1,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))
<span class="kw">lines</span>(x, y2, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Black line is estimate function, red line is Cumulative Distribution Function of <span class="math inline">\(Beta(3,3)\)</span>, estimate function is good.</p>
<p>Estimate <span class="math inline">\(F(x)\)</span> for x = 0.1, 0.2, . . . , 0.9 . The estimations are:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a=<span class="kw">numeric</span>(<span class="dv">9</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">1</span>)){
  a[i]=<span class="kw">cdf.beta</span>(i<span class="op">/</span><span class="dv">10</span>) <span class="co"># use the function to estimate F(x) for x = 0.1, 0.2, . . . , 0.9</span>
}
a</code></pre></div>
<pre><code>## [1] 0.008405925 0.058185856 0.164062176 0.315034421 0.501537914 0.679220967
## [7] 0.834223079 0.941787481 0.983411345</code></pre>
<p>Next get the real values using pbeta function. The real values are:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">b=a=<span class="kw">numeric</span>(<span class="dv">9</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">1</span>)){
  b[i]=<span class="kw">pbeta</span>(i<span class="op">/</span><span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">3</span>) <span class="co">#use pbeta function</span>
}
b</code></pre></div>
<pre><code>## [1] 0.00856 0.05792 0.16308 0.31744 0.50000 0.68256 0.83692 0.94208 0.99144</code></pre>
<p>We find that they are similar.</p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>5.9</p>
<p>The Rayleigh density [156, (18.76)] is <span class="math display">\[f(x)=\frac{x}{\sigma^2} e^{-x^2/(2\sigma^2)} ,   x\geq0,\sigma\geq0.\]</span> Implement a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>)distribution, using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X'}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1,X_2\)</span> ?</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer 2</h2>
<p>5.9</p>
<p>The Cumulative Distribution Function of <span class="math inline">\(f(x)\)</span> is: <span class="math display">\[F(x)=1-e^{-x^2/2\sigma^2}\]</span> so <span class="math inline">\(F^{-1}\)</span> is: <span class="math display">\[F^{-1}(u)=\sqrt{-2\sigma^2ln(1-u)}\]</span></p>
<p>Creat a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>)distribution, using antithetic variables. The functino is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">anti.sample=<span class="cf">function</span>(a,  <span class="dt">n=</span><span class="fl">1e4</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>){
  u &lt;-<span class="st"> </span><span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)
  <span class="cf">if</span> (<span class="op">!</span>antithetic) v &lt;-<span class="st"> </span><span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span> v &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="co"># use antithetic variables</span>
  u &lt;-<span class="st"> </span><span class="kw">c</span>(u, v)
  x=<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>a<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u)) <span class="co">#Inverse transformation</span>
  <span class="kw">return</span>(x)
}</code></pre></div>
<p>Then test the function, use the function to generate 10000 samples which <span class="math inline">\(\sigma=3\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x=<span class="kw">anti.sample</span>(<span class="dv">3</span>)</code></pre></div>
<p>The histogram of it is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(x,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),<span class="dt">probability =</span> <span class="ot">TRUE</span> )</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Add probability density function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(x,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),<span class="dt">probability =</span> <span class="ot">TRUE</span> )
x=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,.<span class="dv">01</span>)
a=<span class="dv">3</span>
y=x<span class="op">/</span>a<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>a<span class="op">^</span><span class="dv">2</span>)) <span class="co">#probability density function</span>
<span class="kw">lines</span>(x,y)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>So the function is good</p>
<p><span class="math inline">\(\sigma=3\)</span>,variance of <span class="math inline">\(\frac{X+X'}{2}\)</span> and variance of <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1,X_2\)</span> is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x1=<span class="kw">anti.sample</span>(<span class="dv">3</span>)
v1=<span class="kw">var</span>((x1[<span class="dv">1</span><span class="op">:</span>(<span class="kw">length</span>(x1)<span class="op">/</span><span class="dv">2</span>)]<span class="op">+</span>x1[(<span class="kw">length</span>(x1)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span><span class="kw">length</span>(x1)])<span class="op">/</span><span class="dv">2</span>)

x2=<span class="kw">anti.sample</span>(<span class="dv">3</span>, <span class="dt">antithetic =</span> <span class="ot">FALSE</span>)
v2=<span class="kw">var</span>((x2[<span class="dv">1</span><span class="op">:</span>(<span class="kw">length</span>(x2)<span class="op">/</span><span class="dv">2</span>)]<span class="op">+</span>x2[(<span class="kw">length</span>(x2)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)<span class="op">:</span><span class="kw">length</span>(x2)])<span class="op">/</span><span class="dv">2</span>)
<span class="kw">c</span>(v1,v2)</code></pre></div>
<pre><code>## [1] 0.09702257 1.95745003</code></pre>
<p>the percent reduction is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(v2<span class="op">-</span>v1)<span class="op">/</span>v2</code></pre></div>
<pre><code>## [1] 0.9504342</code></pre>
<p>So we can see that the variance decrease a lot by using antithetic variables.</p>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>5.13</p>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ??close?? to <span class="math display">\[f(x)=\frac{x^2}{\sqrt{2\pi}} e^{-x^2/2} ,   x&gt;1.\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_1^\infty\frac{x^2}{\sqrt{2\pi}} e^{-x^2/2}dx\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer 3</h2>
<p>5.13</p>
<p>First draw <span class="math inline">\(g(x)\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, .<span class="dv">01</span>)
g=x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>) <span class="co">#g(x)</span>
<span class="kw">plot</span>(x,g,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>I definite: <span class="math display">\[f_1(x)=\frac{1}{\pi}[\frac{1.1}{(x-1.4)^2+1.1^2}]\]</span> <span class="math display">\[f_2(x)=\frac{1}{\sqrt{2\pi}*\sqrt{0.8}} exp(-\frac{(x-1.4)^2}{2*0.8})\]</span></p>
<p>Draw <span class="math inline">\(f_1\)</span> and <span class="math inline">\(0.6*f_2\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, .<span class="dv">01</span>)
g=x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>) <span class="co">#g(x)</span>
<span class="kw">plot</span>(x,g,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>))
f1=<span class="kw">dcauchy</span>(x,<span class="fl">1.4</span>,<span class="fl">1.1</span>) <span class="co">#f1(x)</span>
<span class="kw">lines</span>(x, f1, <span class="dt">lty =</span> <span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="dv">2</span>)
f2=<span class="kw">dnorm</span>(x,<span class="fl">1.4</span>,.<span class="dv">8</span>)<span class="op">*</span>.<span class="dv">6</span> <span class="co">#f2(x)</span>
<span class="kw">lines</span>(x, f2, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">3</span>)  </code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The red line is <span class="math inline">\(f_1\)</span>, the green line is <span class="math inline">\(0.6*f_2\)</span></p>
<p>Because <span class="math inline">\(0.6*f_2\)</span> is more similar to <span class="math inline">\(g\)</span> than <span class="math inline">\(f_1\)</span>.</p>
<p>I think <span class="math inline">\(f_2\)</span> should produce the smaller variance in estimating</p>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p>5.14</p>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[\int_1^\infty\frac{x^2}{\sqrt{2\pi}} e^{-x^2/2}dx\]</span> by importance sampling.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer 4</h2>
<p>5.14</p>
<p>Use the conclusion of 5.13, make <span class="math display">\[f(x)=\frac{1}{\sqrt{2\pi}*\sqrt{0.8}} exp(-\frac{(x-1.4)^2}{2*0.8})\]</span> So <span class="math inline">\(f(x)\)</span> is a probability density function.</p>
<p>Generate 100000 random samples and estimate integrationis</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n=<span class="fl">1e5</span>
x=<span class="kw">rnorm</span>(n,<span class="fl">1.4</span>,.<span class="dv">8</span>)
g=x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">I</span>(x<span class="op">&gt;</span><span class="dv">1</span>) <span class="co">#g(x)</span>
f=<span class="kw">dnorm</span>(x,<span class="fl">1.4</span>,<span class="fl">0.8</span>) <span class="co">#f(x)</span>
fg=g<span class="op">/</span>f <span class="co">#g(x)/f(x)</span></code></pre></div>
<p>the expection and the variance of estimation is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="kw">mean</span>(fg),<span class="kw">var</span>(fg)) <span class="co"># estimation and variance of estimation</span></code></pre></div>
<pre><code>## [1] 0.40128336 0.07179143</code></pre>
<p>It is good.</p>
</div>
<div id="question-1-2" class="section level2">
<h2>Question 1</h2>
<p>6.9</p>
<p>Let <span class="math inline">\(X\)</span> be a non-negative random variable with <span class="math inline">\(\mu=E[X]&lt;\infty\)</span>. For a random sample <span class="math inline">\(x_1,...,x_n\)</span> from the distribution of <span class="math inline">\(X\)</span>. the Gini ratio is defined by <span class="math display">\[G=\frac{1}{2n^2\mu}\sum_{j=1}^n\sum_{i=1}^n|x_i-x_j|.\]</span> The Gini ratio is applied in economics to measure inequality in income distribution (see e.g. [163]). Note that <span class="math inline">\(G\)</span> can be written in terms of the order statistics <span class="math inline">\(x_{(i)}\)</span> as <span class="math display">\[G=\frac{1}{n^2\mu}\sum_{i=1}^n(2i-n-1)x_{(i)}.\]</span> If the mean is unknown, let <span class="math inline">\(\hat{G}\)</span> be the statistic <span class="math inline">\(G\)</span> with <span class="math inline">\(\mu\)</span> replaced by <span class="math inline">\(\bar{x}\)</span>. Estimate by simulation the mean, median and deciles of<span class="math inline">\(\hat{G}\)</span> if <span class="math inline">\(X\)</span> is standard lognormal. Repeat the procedure for the uniform distribution and Bernoulli(0.1). Also construct density histograms of the replicates in each case.</p>
</div>
<div id="answer-1-2" class="section level2">
<h2>Answer 1</h2>
<p>6.9</p>
<p>First, if <span class="math inline">\(X\)</span> is standard lognormal, we creat samples of <span class="math inline">\(X\)</span>, and get <span class="math inline">\(\hat{G}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">12345</span>)
n=<span class="fl">1e3</span>
m=<span class="fl">1e3</span>
G=<span class="kw">numeric</span>(m)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x=<span class="kw">rlnorm</span>(n) <span class="co">#lognormal</span>
  G[i]=<span class="dv">1</span><span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">mean</span>(x))<span class="op">*</span><span class="kw">sum</span>((<span class="dv">2</span><span class="op">*</span><span class="kw">seq</span>(<span class="dv">1</span>,n)<span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>x[<span class="kw">order</span>(x)]) <span class="co"># caculate gini ratio</span>
}</code></pre></div>
<p>The mean and median of <span class="math inline">\(\hat{G}\)</span> are</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="kw">mean</span>(G),<span class="kw">median</span>(G))</code></pre></div>
<pre><code>## [1] 0.5203298 0.5209140</code></pre>
<p>The deciles of <span class="math inline">\(\hat{G}\)</span> are</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quantile</span>(G, <span class="dt">probs =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>))</code></pre></div>
<pre><code>##        0%       10%       20%       30%       40%       50%       60% 
## 0.4831437 0.5028949 0.5087575 0.5130648 0.5169577 0.5209140 0.5236524 
##       70%       80%       90%      100% 
## 0.5271461 0.5313873 0.5375566 0.5718241</code></pre>
<p>Hist of <span class="math inline">\(\hat{G}\)</span> is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(G,<span class="dt">probability =</span> <span class="ot">TRUE</span> )</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>If <span class="math inline">\(X\)</span> is uniform distribution, we creat samples of <span class="math inline">\(X\)</span>, and get <span class="math inline">\(\hat{G}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">G=<span class="kw">numeric</span>(m)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x=<span class="kw">runif</span>(n) <span class="co">#uniform</span>
  G[i]=<span class="dv">1</span><span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">mean</span>(x))<span class="op">*</span><span class="kw">sum</span>((<span class="dv">2</span><span class="op">*</span><span class="kw">seq</span>(<span class="dv">1</span>,n)<span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>x[<span class="kw">order</span>(x)]) <span class="co"># caculate gini ratio</span>
}</code></pre></div>
<p>The mean and median of <span class="math inline">\(\hat{G}\)</span> are</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="kw">mean</span>(G),<span class="kw">median</span>(G))</code></pre></div>
<pre><code>## [1] 0.3330377 0.3330919</code></pre>
<p>The deciles of <span class="math inline">\(\hat{G}\)</span> are</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quantile</span>(G, <span class="dt">probs =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>))</code></pre></div>
<pre><code>##        0%       10%       20%       30%       40%       50%       60% 
## 0.3113314 0.3229329 0.3263271 0.3293769 0.3311842 0.3330919 0.3352606 
##       70%       80%       90%      100% 
## 0.3375370 0.3392725 0.3424776 0.3637629</code></pre>
<p>Hist of <span class="math inline">\(\hat{G}\)</span> is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(G,<span class="dt">probability =</span> <span class="ot">TRUE</span> )</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAq1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa229u22/+2///bkDrbkGbbtmbbtpDb27bb29vb2//b////tmb/25D/27b//7b//9v////fCQviAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIYUlEQVR4nO2da2ObNhiFcZss3tJuXbx0S7Ot20K3ZfSymcTm//+y6YKAxJYOAgHCnOdDazu8Aj0W4mLxKimIk2TqDYgdCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCDCwoP1tcr7V/19Ubxp//vOf0Cv8sE6SN+bd57dJkrx881+PAicV9Hj9IrSgXBhJrqqVa1bvuhc4pqAD0iS4oCxZ3dXrNvRYzQQt6OOl+E6/u5d+ym2Xe8LLH1Xj2n9IkrM7ZU7U9bfr5MV98flaLPda1Hu3SS4+Xyarm+LjWixVr6YqQBVZKhKNaXUjPvu0rtpUB8YXlFVfqhFUfiIX1N/66rL++Hybl/vJnRSkuXzaLOoCGoJEUaWph1c32+Ob14LhBRlKQbIVbItP6kvVu9jDuvR2pb71i+0+Nd7O74t/RdRXW7nQlRJ0JWOTm3J5RbOAeheTKwpQg9EFidqc/V3+VQsqe6JUNyr5WtRNCzKd65e/LmUB4nNhQv+rjDWLKcx+WQpqLNCH0QXpT3SPo6pk9kJZNfP6SV33v5gCdKPQ/9b1bxZwKCivdt9ujN8HPV7rLuWP0oPZFURN3pnXTUHS6Nn7LxuroGYBh7vY/ASJ059fL02X2qIFaRM7uyBLCyo76TkKku9/rnscex+k6qoaRtVJHxFk6YOqw/z+y/WcBInN/l7tZ+rAI2tjP4qZFnS+fby190GWo1iz/6svPrwZvwV9qE5rVPN3nQdVfZCzk26eBzUFNS41brrXYIJd7JPsgV7fF+Vp8315IvyTDhAffXt/cBQ7+z0TH9kENQpoChKnB2/X1Tl6R+K83ZH26DQCE5mgVHUXonWEOAkOQmSC8qTuoeIgMkHFo+w11LV+JMQmKDooCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBIhLUPKMqbenCCUoVJUS59tJCLwNFDRscRTkF05BIJyCQDgFgfAYDvpxCwpZdkcoCEBBAAoCUBCAggB+azUPOVqThSxcUGaegsxtSQ2WLWh/Wz9Ga3lkctmCdpsqUVFu2cmWLYgtCJGZdCzsgyyYDEfWh7aXLmjo4k5W0Cg37ecj6GFtTbu3bEFVjjX7ufSyBZmD1zJbUKukcbuNPH4tU5DOwgPzxqWru8UKKlo5EhesCxakFbkznz6sXy5WkExO805ccrmzG+1vk0UKkgdxbcZ2qe5VXNsA109fUQnabUIkNfIX5AqPS9APZZLhXimeFyAoo6Bja03rbqBXCt2TFVS3oEDFdQuIWdBExVGQV0C0gnabq+peBjvpIddKQaGLm5EgsZupiQi6ZJntfk96RoJSOWPBRZH2SjN7woLk78q5uEznpYZlG6SgVKa5piDLWtMLecd5t+EuZlmrOBGS8zb0y3R9yoKmKY6CvAKiFgTHH/oV1ykgakFpiNniBhU0yZMbjcP8JJNNdW5BEwjqMVPiYXHdAmIW1PcA/6y4bgExC1LXGYjwA8nnI6jNDbMBBpLPR1ALhhgGfFKCwgwkdx2t4xakZp9MHQf7MC3Io9ZxCcpXd5m8mncYCjKQfK6CZPOQ7cJ5PyjEQPK5CpIdjBQ0+B3FuQoyLSjtctfe5wpproLKPihzni5mSTm9sG1HPGVBuoNxjqLK1Izd8pJkkYIg+jCvhjBS0DHMiaLophYoSB/BnT10daKYXixPUFp2vs4BZkaLnovZVVyLNeJ3MQnK61na3Ucx/df97cIENe6WDf7b/CwFNa7ABv/peaaC4I0Mn+I8FqEgsAgFgUUoCCwyG0HwcV2f4jwWmYmgMYujIK9FKAgsQkFgEQoCiyxE0CLuSY9VHAV5LUJBYBEKKgqP4Qo+gkYasTiKoI7vugcGhIIAFASgIAAFASgIQEEACgJQEICCABQEoCCAX8ktH2ZJul6edhc02KWrV1ltH2YJ1RC6Bk4lqPWjCEsVZP+B+lnjfr6LxcVwglq0oNPDsw9CD7OcHn4NDj7McnoMdwJxIgwiaNpO+JBedQklpXWhrj+OHwihIAAFASgIQEEACgJQEICCABQE4KUGgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQECCcqbuauy+s3DN+AZ6uOBGUiFZQvUP2yGyNpbEUaQTB5TJZCR2T/KN7sNeMj8eGCjBL/Ah69DTJL2hCCC9KiGMm+MSpSi08nk6Cn844GNEjzX2C8rwlGCCNJJh5p5Y/TmJldgiy2BT174BGZB9y5FGEGqZTdlZKtWc27aA+sXPoHpq6TnJI0HBBGkO4O618irrQSCrIE5qOfxQD2ZuStfrz+DCCqq6ZA9BdWBYEJlR2DgjmigXcxsu/cuVlfaeRhzBbrTsPkyUCdtttK7k66r56ynMzDosT78YV5vaGkGCDoe+KSEwIHeDHCiKPMJm/GeaGOPBzZL8AuUxiLspKtzfX3yIudFNqM90bd5PLBRQvBAT3ixCqAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBohekRvZOmK8odkEq6ZV1zskRiFxQOSrKPeR1UCIXZOYuz8KOafEgbkFgFNUYxC2okblxKuYgSA4bm6yXjl1QuwHpAxK3oKqTpiALZvAzBdnQGZrTsA/J+RC7IH2pMd2JdPyCpoaCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgL8D7kBtHqmspPVAAAAAElFTkSuQmCC" /><!-- --></p>
<p>If <span class="math inline">\(X\)</span> is <span class="math inline">\(Bernoulli(0.1)\)</span>, we creat samples of <span class="math inline">\(X\)</span>, and get <span class="math inline">\(\hat{G}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">G=<span class="kw">numeric</span>(m)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x=<span class="kw">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.1</span>) <span class="co">#bernoulli</span>
  G[i]=<span class="dv">1</span><span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">mean</span>(x))<span class="op">*</span><span class="kw">sum</span>((<span class="dv">2</span><span class="op">*</span><span class="kw">seq</span>(<span class="dv">1</span>,n)<span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>x[<span class="kw">order</span>(x)]) <span class="co"># caculate gini ratio</span>
}</code></pre></div>
<p>The mean and median of <span class="math inline">\(\hat{G}\)</span> are</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="kw">mean</span>(G),<span class="kw">median</span>(G))</code></pre></div>
<pre><code>## [1] 0.900015 0.900000</code></pre>
<p>The deciles of <span class="math inline">\(\hat{G}\)</span> are</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quantile</span>(G, <span class="dt">probs =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>))</code></pre></div>
<pre><code>##    0%   10%   20%   30%   40%   50%   60%   70%   80%   90%  100% 
## 0.865 0.887 0.892 0.895 0.897 0.900 0.903 0.906 0.908 0.912 0.930</code></pre>
<p>Hist of <span class="math inline">\(\hat{G}\)</span> is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(G,<span class="dt">probability =</span> <span class="ot">TRUE</span> )</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>I find gini ratio of uniform(0,1) is smaller, gini ratio of Bernoulli(0.1) is bigger.</p>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>6.10</p>
<p>Construct an approximate 95% confidence interval for the Gini ratio <span class="math inline">\(\gamma=E[G]\)</span> if <span class="math inline">\(X\)</span> is lognormal with unknown parameters. Assess the coverage rate of the estimation procedure with a Monte Carlo experiment.</p>
</div>
<div id="answer-2-1" class="section level2">
<h2>Answer 2</h2>
<p>6.10</p>
<p>Creat a function to caculate 95% confidence interval for the Gini ratio <span class="math inline">\(\gamma=E[G]\)</span> if X~lognormal(me,s)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="fl">1e3</span>; n &lt;-<span class="st"> </span><span class="fl">1e3</span>;
confi.interval=<span class="cf">function</span>(me,s){
  g.hat=<span class="kw">numeric</span>(m)
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
    x &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n,me,s) <span class="co">#lognormal</span>
    g.hat[i]=<span class="dv">1</span><span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">mean</span>(x))<span class="op">*</span><span class="kw">sum</span>((<span class="dv">2</span><span class="op">*</span><span class="kw">seq</span>(<span class="dv">1</span>,n)<span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>x[<span class="kw">order</span>(x)]) <span class="co">#caculate Gini ratio</span>
  }
  a=<span class="kw">quantile</span>(g.hat, <span class="dt">probs =</span> <span class="fl">0.025</span>,<span class="dt">names=</span><span class="ot">FALSE</span>)
  b=<span class="kw">quantile</span>(g.hat, <span class="dt">probs =</span> <span class="fl">0.975</span>,<span class="dt">names=</span><span class="ot">FALSE</span>)
  <span class="kw">c</span>(a,b) <span class="co">#95% confidence interva</span>
}</code></pre></div>
<p>Just consider lognormal(0,1) (meanlog = 0, sdlog = 1). We use the function to caculate the 95% confidence interval:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">me=<span class="dv">0</span>
s=<span class="dv">1</span>
c=<span class="kw">confi.interval</span>(me,s)
a=c[<span class="dv">1</span>]
b=c[<span class="dv">2</span>]
c <span class="co">#95% confidence interva</span></code></pre></div>
<pre><code>## [1] 0.4941257 0.5461620</code></pre>
<p>Now, caculate the coverage rate of the estimation. The coverage rate is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">I=<span class="kw">numeric</span>(m)
g.hat=<span class="kw">numeric</span>(m)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n,me,s) <span class="co"># lognormal</span>
  g.hat[i]=<span class="dv">1</span><span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">mean</span>(x))<span class="op">*</span><span class="kw">sum</span>((<span class="dv">2</span><span class="op">*</span><span class="kw">seq</span>(<span class="dv">1</span>,n)<span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>x[<span class="kw">order</span>(x)]) <span class="co">#caculate gini ratio</span>
  <span class="cf">if</span>(g.hat[i]<span class="op">&gt;</span>a <span class="op">&amp;&amp;</span><span class="st"> </span>g.hat[i]<span class="op">&lt;</span>b){ <span class="co">#see if it in 95% confidence interval</span>
    I[i]=<span class="dv">1</span> <span class="co"># in 95% confidence interval</span>
  }
  <span class="cf">else</span>{
    I[i]=<span class="dv">0</span> <span class="co"># not in 95% confidence interval</span>
  }
}
<span class="kw">mean</span>(I)</code></pre></div>
<pre><code>## [1] 0.962</code></pre>
<p>It is close to theoretical value</p>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>6.B</p>
<p>Tests for association based on Pearson product moment correlation <span class="math inline">\(\rho\)</span>, Spearman??s rank correlation coefficient <span class="math inline">\(\rho_s\)</span>, or Kendall??s coefficient <span class="math inline">\(\tau\)</span>, are implemented in cor.test. Show (empirically) that the nonparametric tests based <span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the correlation test when the sampled distribution is bivariate normal. Find an example of an alternative (a bivariate <span class="math inline">\((X,Y)\)</span> such that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent) such that at least one of the nonparametric tests have better empirical power than the correlation test against this alternative. distribution on</p>
</div>
<div id="answer-3-1" class="section level2">
<h2>Answer 3</h2>
<p>6.B</p>
<p>(1)First when the sampled distribution is bivariate normal, We make X and Y are bivariate normal, and <span class="math inline">\(\mu(x)=\mu(Y)=0, var(X)=var(Y)=1, cov(X,Y)=0.5\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
a &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="fl">1e2</span>,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dv">1</span>),<span class="dv">2</span>))
x=a[,<span class="dv">1</span>]
y=a[,<span class="dv">2</span>]
<span class="kw">cor.test</span>(x,y,<span class="dt">method =</span> <span class="st">&quot;pearson&quot;</span>)</code></pre></div>
<pre><code>## 
##  Pearson's product-moment correlation
## 
## data:  x and y
## t = 5.793, df = 98, p-value = 8.378e-08
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.3426341 0.6381713
## sample estimates:
##       cor 
## 0.5050618</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(x,y,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</code></pre></div>
<pre><code>## 
##  Spearman's rank correlation rho
## 
## data:  x and y
## S = 93708, p-value = 6.591e-06
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.4376958</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(x,y,<span class="dt">method =</span> <span class="st">&quot;kendall&quot;</span>)</code></pre></div>
<pre><code>## 
##  Kendall's rank correlation tau
## 
## data:  x and y
## z = 4.485, p-value = 7.29e-06
## alternative hypothesis: true tau is not equal to 0
## sample estimates:
##       tau 
## 0.3042424</code></pre>
<p>We can find that Pearson product moment correlation is much close to the true value.So the nonparametric tests are less powerful than the correlation test when the sampled distribution is bivariate normal.</p>
<p>(2)When X and Y are dependent. The example is that we make X~exp(1), Z~ P(Z=1000)=0.1, P(Z=0)=0.9 and Y=X+Z, X and Y are dependent, so the theoretical value of correlation is not equal to 0, and should much bigger than 0.</p>
<p>We now caculate Pearson product moment correlation, Spearman??s rank correlation coefficient and Kendall??s coefficient.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x=<span class="kw">rexp</span>(<span class="fl">1e3</span>) <span class="co">#X~exp(1)</span>
z=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1e3</span>), <span class="dt">size=</span><span class="fl">1e3</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">0.1</span>))
y=x<span class="op">+</span>z

<span class="kw">cor.test</span>(x,y,<span class="dt">method =</span> <span class="st">&quot;pearson&quot;</span>)</code></pre></div>
<pre><code>## 
##  Pearson's product-moment correlation
## 
## data:  x and y
## t = 0.010409, df = 998, p-value = 0.9917
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.06166487  0.06232129
## sample estimates:
##          cor 
## 0.0003294759</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(x,y,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</code></pre></div>
<pre><code>## 
##  Spearman's rank correlation rho
## 
## data:  x and y
## S = 27259000, p-value &lt; 2.2e-16
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.8364488</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(x,y,<span class="dt">method =</span> <span class="st">&quot;kendall&quot;</span>)</code></pre></div>
<pre><code>## 
##  Kendall's rank correlation tau
## 
## data:  x and y
## z = 39.467, p-value &lt; 2.2e-16
## alternative hypothesis: true tau is not equal to 0
## sample estimates:
##       tau 
## 0.8335015</code></pre>
<p>We find that Spearman??s rank correlation coefficient and Kendall??s coefficient are much bigger than 0. Pearson product moment correlation is close to 0.Then we see the p-value, the p-value of tow nonparametric tests are smaller and p-value of Pearson test is bigger. So in this example, two nonparametric tests both have better empirical power than the correlation test.</p>
</div>
<div id="question-1-3" class="section level2">
<h2>Question 1</h2>
<p>7.1</p>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-1-3" class="section level2">
<h2>Answer 1</h2>
<p>7.1</p>
<p>first, input the data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bootstrap)
<span class="kw">set.seed</span>(<span class="dv">1</span>)
x=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">576</span>,<span class="dv">635</span>,<span class="dv">558</span>,<span class="dv">578</span>,<span class="dv">666</span>,<span class="dv">580</span>,<span class="dv">555</span>,<span class="dv">661</span>,<span class="dv">651</span>,<span class="dv">605</span>,<span class="dv">653</span>,<span class="dv">575</span>,<span class="dv">545</span>,<span class="dv">572</span>,<span class="dv">594</span>,<span class="dv">339</span>,<span class="dv">330</span>,<span class="dv">281</span>,<span class="dv">303</span>,<span class="dv">344</span>,<span class="dv">307</span>,<span class="dv">300</span>,<span class="dv">343</span>,<span class="dv">336</span>,<span class="dv">313</span>,<span class="dv">312</span>,<span class="dv">274</span>,<span class="dv">276</span>,<span class="dv">288</span>,<span class="dv">296</span>),<span class="dt">ncol=</span><span class="dv">2</span>)
x <span class="co">#print x</span></code></pre></div>
<pre><code>##       [,1] [,2]
##  [1,]  576  339
##  [2,]  635  330
##  [3,]  558  281
##  [4,]  578  303
##  [5,]  666  344
##  [6,]  580  307
##  [7,]  555  300
##  [8,]  661  343
##  [9,]  651  336
## [10,]  605  313
## [11,]  653  312
## [12,]  575  274
## [13,]  545  276
## [14,]  572  288
## [15,]  594  296</code></pre>
<p>then, calculate the bias and the standard error</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">b.cor &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">cor</span>(x[i,<span class="dv">1</span>],x[i,<span class="dv">2</span>])
n=<span class="kw">nrow</span>(x) <span class="co">#length</span>
theta.hat &lt;-<span class="st"> </span><span class="kw">b.cor</span>(x,<span class="dv">1</span><span class="op">:</span>n)
theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
  theta.jack[i] &lt;-<span class="st"> </span><span class="kw">b.cor</span>(x,(<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>i]) <span class="co">#jackknife</span>
}
bias.jack &lt;-<span class="st"> </span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat) <span class="co">#bias</span>
se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span>theta.hat)<span class="op">^</span><span class="dv">2</span>)) <span class="co">#se</span>
<span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">bias=</span>bias.jack, <span class="dt">se=</span>se.jack),<span class="dv">3</span>) <span class="co"># estimation, bias and the standard error</span></code></pre></div>
<pre><code>##   bias     se 
## -0.006  0.143</code></pre>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<p>7.5</p>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-2-2" class="section level2">
<h2>Answer 2</h2>
<p>7.5</p>
<p>Compute 95% bootstrap confidence intervals</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(boot)
theta.boot &lt;-<span class="st"> </span><span class="cf">function</span>(dat,i) {
<span class="co">#function to compute the statistic</span>
  y &lt;-<span class="st"> </span>dat[i, <span class="dv">1</span>]
  <span class="kw">mean</span>(y)
}
boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(aircondit, <span class="dt">statistic =</span> theta.boot, <span class="dt">R =</span> <span class="dv">2000</span>)
<span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.obj,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,  <span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))</code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 33.8, 181.2 )   ( 25.6, 172.1 )  
## 
## Level     Percentile            BCa          
## 95%   ( 44.1, 190.6 )   ( 55.2, 229.3 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>They are different. The intervals of Basic are smaller, the intervals of BCa are bigger.</p>
<p>I think it is because the model are not same, so the ways of generating data and calculations are different.So the results are different.</p>
</div>
<div id="question-3-2" class="section level2">
<h2>Question 3</h2>
<p>7.8</p>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span></p>
</div>
<div id="answer-3-2" class="section level2">
<h2>Answer 3</h2>
<p>7.8</p>
<p>compute the jackknife estimates of bias and standard error</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pca &lt;-<span class="st"> </span><span class="cf">function</span>(x,i){
  lambda1=<span class="kw">rev</span>(<span class="kw">sort</span>(<span class="kw">eigen</span>(<span class="kw">cov</span>(x[i,]))<span class="op">$</span>values))[<span class="dv">1</span>]
  sig=<span class="kw">sum</span>(<span class="kw">rev</span>(<span class="kw">sort</span>(<span class="kw">eigen</span>(<span class="kw">cov</span>(x[i,]))<span class="op">$</span>values)))
  lambda1<span class="op">/</span>sig
}
x=scor
n=<span class="kw">nrow</span>(x) <span class="co">#length</span>
theta.hat &lt;-<span class="st"> </span><span class="kw">pca</span>(x,<span class="dv">1</span><span class="op">:</span>n)
theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
  theta.jack[i] &lt;-<span class="st"> </span><span class="kw">pca</span>(x,(<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>i]) <span class="co">#jackknife</span>
}
bias.jack &lt;-<span class="st"> </span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat) <span class="co">#bias</span>
se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span>theta.hat)<span class="op">^</span><span class="dv">2</span>)) <span class="co">#se</span>
<span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">bias=</span>bias.jack, <span class="dt">se=</span>se.jack),<span class="dv">3</span>) <span class="co"># estimation, bias and the standard error</span></code></pre></div>
<pre><code>##  bias    se 
## 0.001 0.050</code></pre>
</div>
<div id="question-4-1" class="section level2">
<h2>Question 4</h2>
<p>7.11</p>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-4-1" class="section level2">
<h2>Answer 4</h2>
<p>7.11</p>
<p>First, use leave-one-out cross validation to compare the models</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DAAG,<span class="dt">quietly=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
## 载入程辑包：'lattice'</code></pre>
<pre><code>## The following object is masked from 'package:boot':
## 
##     melanoma</code></pre>
<pre><code>## 
## 载入程辑包：'DAAG'</code></pre>
<pre><code>## The following object is masked from 'package:MASS':
## 
##     hills</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(ironslag)
    n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic)   <span class="co">#in DAAG ironslag</span>
    e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)

    <span class="co"># for n-fold cross validation</span>
    <span class="co"># fit models on leave-one-out samples</span>
    <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {
        y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k]
        x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]

        J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)
        yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]
        e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1

        J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))
        yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span>
<span class="st">                </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span>
        e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2

        J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)
        logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]
        yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)
        e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3

        J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))
        logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[k])
        yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)
        e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4
    }

    <span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 20.45424</code></pre>
<p>MSE of model 2 are smaller, so the best model is model two.</p>
<p>then, use leave-two-out cross validation to compare the models</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DAAG)
    n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic);   <span class="co">#in DAAG ironslag</span>
    e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)

    <span class="co"># for n-fold cross validation</span>
    <span class="co"># fit models on leave-one-out samples</span>
    <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {
      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
        y &lt;-<span class="st"> </span>magnetic[<span class="kw">c</span>(<span class="op">-</span>k,<span class="op">-</span>j)]
        x &lt;-<span class="st"> </span>chemical[<span class="kw">c</span>(<span class="op">-</span>k,<span class="op">-</span>j)]

        J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)
        yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]
        e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1

        J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))
        yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span>
<span class="st">                </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span>
        e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2

        J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)
        logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]
        yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)
        e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3

        J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))
        logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[k])
        yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)
        e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4
    }
    }

    <span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 19.58175 17.91919 18.74389 20.80684</code></pre>
<p>MSE of model 2 are smaller, so the best model is model two.</p>
<p>It is same as previous results.</p>
</div>
<div id="question-1-4" class="section level2">
<h2>Question 1</h2>
<p>8.1</p>
<p>Implement the two-sample Cram??er-von Mises test for equal distributions as a permutation test. Apply the test to the data in Examples 8.1 and 8.2.</p>
</div>
<div id="answer-1-4" class="section level2">
<h2>Answer 1</h2>
<p>8.1</p>
<p>Use Cramer-von Mises test</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">attach</span>(chickwts)
x &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed <span class="op">==</span><span class="st"> &quot;soybean&quot;</span>]))
y &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed <span class="op">==</span><span class="st"> &quot;linseed&quot;</span>]))
<span class="kw">detach</span>(chickwts)
R &lt;-<span class="st"> </span><span class="dv">999</span> <span class="co">#number of replicates</span>
z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y) <span class="co">#pooled sample</span>
K &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">26</span>
D &lt;-<span class="st"> </span><span class="kw">numeric</span>(R) <span class="co">#storage for replicates</span>

CM=<span class="cf">function</span>(x,y){
  lx=<span class="kw">length</span>(x)
  ly=<span class="kw">length</span>(y)
  s1=<span class="kw">sum</span>((<span class="kw">ecdf</span>(x)(x)<span class="op">-</span><span class="kw">ecdf</span>(y)(x))<span class="op">^</span><span class="dv">2</span>)
  s2=<span class="kw">sum</span>((<span class="kw">ecdf</span>(x)(y)<span class="op">-</span><span class="kw">ecdf</span>(y)(y))<span class="op">^</span><span class="dv">2</span>)
  <span class="kw">return</span>((lx<span class="op">*</span>ly)<span class="op">/</span>(lx<span class="op">+</span>ly)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(s1<span class="op">+</span>s2))
}

D0 &lt;-<span class="st"> </span><span class="kw">CM</span>(x,y)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {
<span class="co">#generate indices k for the first sample</span>
k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)
x1 &lt;-<span class="st"> </span>z[k]
y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] <span class="co">#complement of x1</span>
D[i] &lt;-<span class="st"> </span><span class="kw">CM</span>(x1,y1)
}</code></pre></div>
<p>p-value is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(D0, D) <span class="op">&gt;=</span><span class="st"> </span>D0)
<span class="kw">print</span>(p)</code></pre></div>
<pre><code>## [1] 0.421</code></pre>
<p>so accept H0, x and y are from same distribution.</p>
</div>
<div id="question-2-3" class="section level2">
<h2>Question 2</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<p>Unequal variances and equal expectations Unequal variances and unequal expectations Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions) Unbalanced samples (say, 1 case versus 10 controls) Note: The parameters should be choosen such that the powers are distinguishable (say, range from 0.3 to 0.9).</p>
</div>
<div id="answer-2-3" class="section level2">
<h2>Answer 2</h2>
<p>We can compare the p-value</p>
<p>first design compare function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RANN)
<span class="kw">library</span>(energy)
<span class="kw">library</span>(Ball)
<span class="kw">library</span>(boot)

com=<span class="cf">function</span>(x,y){
  z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)
  Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {
  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2
  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);
  z &lt;-<span class="st"> </span>z[ix, ];
  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what's the first column?</span>
  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]
  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]
  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>.<span class="dv">5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="op">+</span>.<span class="dv">5</span>)
  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)
  }
  <span class="kw">set.seed</span>(<span class="dv">12345</span>); N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(x), <span class="kw">length</span>(y))
  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> Tn, <span class="dt">R =</span> <span class="dv">999</span>,
  <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> N,<span class="dt">k=</span><span class="dv">3</span>)
  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)
  pnn.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])
  
  boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z, <span class="dt">sizes=</span>N, <span class="dt">R=</span><span class="dv">999</span>)
  pen.value &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value
  
  pba.value =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">R=</span><span class="dv">999</span>)<span class="op">$</span>p.value
  <span class="kw">return</span>(<span class="kw">c</span>(pnn.value, pen.value, pba.value))
}</code></pre></div>
<p>now use this function to compare three methods.</p>
<p>1.Unequal variances and equal expectations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x=<span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">1</span>)
y=<span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="fl">1.1</span>)
<span class="kw">com</span>(x,y)</code></pre></div>
<pre><code>##                     bd.pvalue 
## 0.9680000 0.5470000 0.3535354</code></pre>
<p>in this situation, ball is better</p>
<p>2.Unequal variances and unequal expectations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x=<span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">1</span>)
y=<span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="fl">0.1</span>,<span class="fl">1.1</span>)
<span class="kw">com</span>(x,y)</code></pre></div>
<pre><code>##                        bd.pvalue 
## 0.39300000 0.05400000 0.01010101</code></pre>
<p>in this situation, ball is better</p>
<p>3.Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x=<span class="kw">rt</span>(<span class="dv">100</span>,<span class="dv">1</span>)
y=<span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="dv">50</span>,<span class="fl">0.1</span>),<span class="kw">rnorm</span>(<span class="dv">50</span>,<span class="op">-</span><span class="fl">0.1</span>))
<span class="kw">print</span>(<span class="kw">com</span>(x,y))</code></pre></div>
<pre><code>##                     bd.pvalue 
##     0.007     0.001     0.010</code></pre>
<p>in this situation, energy and ball are better</p>
<p>4,Unbalanced samples (say, 1 case versus 10 controls)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x=<span class="kw">rnorm</span>(<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">1</span>)
y=<span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="fl">1.1</span>)
<span class="kw">com</span>(x,y)</code></pre></div>
<pre><code>##                     bd.pvalue 
## 0.2270000 0.1800000 0.1010101</code></pre>
<p>in this situation, NN is better</p>
</div>
<div id="question-3-3" class="section level2">
<h2>Question 3</h2>
<p>9.3</p>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1). Recall that a Cauchy(<span class="math inline">\(\theta\)</span>, <span class="math inline">\(\eta\)</span>) distribution has density function</p>
<p><span class="math display">\[f(x)=\frac{1}{\theta \pi(1+[(\pi-\eta)/\theta]^2)}, -\infty&lt;x&lt;\infty, \theta&gt;0\]</span> The standard Cauchy has the Cauchy(<span class="math inline">\(\theta\)</span> = 1, <span class="math inline">\(\eta\)</span> = 0) density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)</p>
</div>
<div id="answer-3-3" class="section level2">
<h2>Answer 3</h2>
<p>9.3</p>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span>(pi<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))) <span class="co"># standard Cauchy distribution</span>
}

m &lt;-<span class="st"> </span><span class="dv">10000</span>
x &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)
x[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)
u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)

<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {
  xt &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]
  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,xt)
  num &lt;-<span class="st"> </span><span class="kw">f</span>(y) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(xt,y)
  den &lt;-<span class="st"> </span><span class="kw">f</span>(xt) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(y, xt)
  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>num<span class="op">/</span>den) x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {
    x[i] &lt;-<span class="st"> </span>xt
    k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span>     <span class="co">#y is rejected</span>
  }
}

b &lt;-<span class="st"> </span><span class="dv">1001</span>      <span class="co">#discard the burnin sample</span>
y &lt;-<span class="st"> </span>x[b<span class="op">:</span>m]
a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</code></pre></div>
<p>hist it and Cauchy distribution</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(y, <span class="dt">breaks=</span><span class="st">&quot;scott&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="dv">10</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>))
<span class="kw">lines</span>(a, <span class="kw">f</span>(a))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>compare the deciles</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quantile</span>(y,<span class="dt">probs=</span><span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>))</code></pre></div>
<pre><code>##         10%         20%         30%         40%         50%         60% 
## -3.26220727 -1.52502920 -0.82960890 -0.42066521 -0.06073828  0.26356558 
##         70%         80%         90% 
##  0.63315577  1.27640581  2.98544814</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qcauchy</span>(<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>))</code></pre></div>
<pre><code>## [1] -3.0776835 -1.3763819 -0.7265425 -0.3249197  0.0000000  0.3249197
## [7]  0.7265425  1.3763819  3.0776835</code></pre>
<p>it is similar</p>
</div>
<div id="question-4-2" class="section level2">
<h2>Question 4</h2>
<p>9.6</p>
<p>Rao [220, Sec. 5g] presented an example on genetic linkage of 197 animals in four categories (also discussed in [67, 106, 171, 266]). The group sizes are (125, 18, 20, 34). Assume that the probabilities of the corresponding multinomial distribution are</p>
<p><span class="math display">\[(\frac{1}{2}+\frac{\theta}{4},\frac{1-\theta}{4},\frac{1-\theta}{4},\frac{\theta}{4})\]</span></p>
<p>Estimate the posterior distribution of <span class="math inline">\(\theta\)</span> given the observed sample, using one of the methods in this chapter.</p>
</div>
<div id="answer-4-2" class="section level2">
<h2>Answer 4</h2>
<p>estimate the <span class="math inline">\(\theta\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">w &lt;-<span class="st"> </span>.<span class="dv">25</span> <span class="co">#width of the uniform support set</span>
m &lt;-<span class="st"> </span><span class="dv">5000</span> <span class="co">#length of the chain</span>
win=<span class="kw">c</span>(<span class="dv">125</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">34</span>)
x &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#the chain</span>

prob &lt;-<span class="st"> </span><span class="cf">function</span>(y, win) {
  <span class="co"># computes (without the constant) the target density</span>
  <span class="cf">if</span> (y <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">||</span><span class="st"> </span>y <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.8</span>)
  <span class="kw">return</span> (<span class="dv">0</span>)
  <span class="kw">return</span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">+</span>y<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>win[<span class="dv">1</span>] <span class="op">*</span>
<span class="st">  </span>((<span class="dv">1</span><span class="op">-</span>y)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>win[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span><span class="op">-</span>y)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>win[<span class="dv">3</span>] <span class="op">*</span>
<span class="st">  </span>(y<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>win[<span class="dv">4</span>] )
}

u &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#for accept/reject step</span>
v &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="op">-</span>w, w) <span class="co">#proposal distribution</span>
x[<span class="dv">1</span>] &lt;-<span class="st"> </span>.<span class="dv">25</span>

<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {
  y &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>v[i]
  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">prob</span>(y, win) <span class="op">/</span><span class="st"> </span><span class="kw">prob</span>(x[i<span class="op">-</span><span class="dv">1</span>], win))
  x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span>
  x[i] &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]
}

index=<span class="dv">1001</span><span class="op">:</span>m</code></pre></div>
<p><span class="math inline">\(\hat{\theta}\)</span> is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">theta.hat=<span class="kw">mean</span>(x[index])
<span class="kw">print</span>(theta.hat)</code></pre></div>
<pre><code>## [1] 0.6210822</code></pre>
</div>
<div id="question-1-5" class="section level2">
<h2>Question 1</h2>
<p>9.6</p>
<p>For exercise 9.6, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until the chain has converged approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span></p>
</div>
<div id="answer-1-5" class="section level2">
<h2>Answer 1</h2>
<p>9.6</p>
<p>First, write Gelman-Rubin function. Then, use the Gelman-Rubin method to monitor convergence of the chain.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {
  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span>
  <span class="co"># for chain in i-th row of X</span>
  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)
  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)
  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)
  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means</span>
  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span>
  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span>
  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est.</span>
  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est.</span>
  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span>
  <span class="kw">return</span>(r.hat)
}

w &lt;-<span class="st"> </span>.<span class="dv">25</span> <span class="co">#width of the uniform support set</span>
m &lt;-<span class="st"> </span><span class="dv">5000</span> <span class="co">#length of the chain</span>
win=<span class="kw">c</span>(<span class="dv">125</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">34</span>)
x &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#the chain</span>
prob &lt;-<span class="st"> </span><span class="cf">function</span>(y, win) {
  <span class="co"># computes (without the constant) the target density</span>
  <span class="cf">if</span> (y <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">||</span><span class="st"> </span>y <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.9</span>)
  <span class="kw">return</span> (<span class="dv">0</span>)
  <span class="kw">return</span>((<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">+</span>y<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>win[<span class="dv">1</span>] <span class="op">*</span>
<span class="st">  </span>((<span class="dv">1</span><span class="op">-</span>y)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>win[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>((<span class="dv">1</span><span class="op">-</span>y)<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>win[<span class="dv">3</span>] <span class="op">*</span>
<span class="st">  </span>(y<span class="op">/</span><span class="dv">4</span>)<span class="op">^</span>win[<span class="dv">4</span>] )
}

u &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#for accept/reject step</span>
v &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="op">-</span>w, w) <span class="co">#proposal distribution</span>
x[<span class="dv">1</span>] &lt;-<span class="st"> </span>.<span class="dv">25</span>

this.chain &lt;-<span class="st"> </span><span class="cf">function</span>(win, N, X1) {
  <span class="co">#starting value X1</span>
  x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)
  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>X1
  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)
  
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {
    y &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>v[i]
    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">prob</span>(y, win) <span class="op">/</span><span class="st"> </span><span class="kw">prob</span>(x[i<span class="op">-</span><span class="dv">1</span>], win))
    x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span>
    x[i] &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]
  }
  <span class="kw">return</span>(x)
}

k &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#number of chains to generate</span>
n &lt;-<span class="st"> </span><span class="dv">5000</span> <span class="co">#length of chains</span>
b &lt;-<span class="st"> </span><span class="dv">500</span> <span class="co">#burn-in length</span>
<span class="co">#choose overdispersed initial values</span>
x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>)
<span class="co">#generate the chains</span>
X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)
  X[i, ] &lt;-<span class="st"> </span><span class="kw">this.chain</span>(win, n, x0[i])

psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))
psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))
<span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</code></pre></div>
<pre><code>## [1] 1.046847</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#plot psi for the four chains</span>
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))
<span class="co">#for (i in 1:k)</span>
<span class="co">#plot(psi[i, (b+1):n], type=&quot;l&quot;,</span>
<span class="co">#xlab=i, ylab=bquote(psi))</span>
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span>
<span class="co">#plot the sequence of R-hat statistics</span>
rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)
<span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)
rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])
<span class="co">#plot(rhat[(b+1):n], type=&quot;l&quot;, xlab=&quot;&quot;, ylab=&quot;R&quot;)</span>
<span class="co">#abline(h=1.1, lty=2)</span></code></pre></div>
<p>We can see that we have run the chain until the chain has converged approximately to the target distribution according to<span class="math inline">\(\hat{R}&lt;1.2\)</span></p>
</div>
<div id="question-2-4" class="section level2">
<h2>Question 2</h2>
<p>11.4</p>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt{k}\)</span> of the curves</p>
<p><span class="math display">\[S_{k-1}(a)=P(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}})\]</span></p>
<p>and</p>
<p><span class="math display">\[S_{k}(a)=P(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}})\]</span></p>
<p>for k = 4 : 25, 100, 500, 1000, where t(k) is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Sz??ekely [260].)</p>
</div>
<div id="answer-2-4" class="section level2">
<h2>Answer 2</h2>
<p>Use uniroot function to get the intersection points’ abscissa.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">u=<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">4</span>,<span class="dv">25</span>),<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)
b=<span class="kw">numeric</span>(<span class="kw">length</span>(u))
c=<span class="kw">numeric</span>(<span class="kw">length</span>(u))
s1=<span class="cf">function</span>(a){   <span class="co">#S_k-1</span>
  <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k<span class="op">-</span><span class="dv">1</span>)
}
s2=<span class="cf">function</span>(a){   <span class="co">#S_k</span>
  <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k)
}
s=<span class="cf">function</span>(a){   <span class="co">#s1-s2</span>
  <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k<span class="op">-</span><span class="dv">1</span>)<span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k))
}
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(u)){   
  k=u[i]
  b[i]=<span class="kw">uniroot</span>(s,<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">2</span>))<span class="op">$</span>root    <span class="co">#get root</span>
  c[i]=<span class="kw">s1</span>(b[i])
}</code></pre></div>
<p>the result is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">matrix</span>(<span class="kw">c</span>(u,b,c),<span class="kw">length</span>(u))</code></pre></div>
<pre><code>##       [,1]     [,2]       [,3]
##  [1,]    4 1.492103 0.07381507
##  [2,]    5 1.533554 0.06627626
##  [3,]    6 1.562745 0.06156861
##  [4,]    7 1.584430 0.05835931
##  [5,]    8 1.601185 0.05603419
##  [6,]    9 1.614522 0.05427354
##  [7,]   10 1.625391 0.05289475
##  [8,]   11 1.634420 0.05178611
##  [9,]   12 1.642039 0.05087552
## [10,]   13 1.648555 0.05011438
## [11,]   14 1.654192 0.04946876
## [12,]   15 1.659115 0.04891427
## [13,]   16 1.663454 0.04843290
## [14,]   17 1.667305 0.04801112
## [15,]   18 1.670747 0.04763852
## [16,]   19 1.673841 0.04730698
## [17,]   20 1.676638 0.04701007
## [18,]   21 1.679179 0.04674264
## [19,]   22 1.681497 0.04650052
## [20,]   23 1.683621 0.04628027
## [21,]   24 1.685573 0.04607906
## [22,]   25 1.687374 0.04589453
## [23,]  100 1.720606 0.04266897
## [24,]  500 1.729753 0.04183751
## [25,] 1000 1.730905 0.04173444</code></pre>
<p>The first col is k, the second and third col is intersection points’ abscissa and Y-axis.</p>
</div>
<div id="question-1-6" class="section level2">
<h2>Question 1</h2>
<p>11.6</p>
<p>Write a function to compute the cdf of the Cauchy distribution, which has density</p>
<p><span class="math display">\[\frac{1}{\theta\pi(1+[(\pi-\eta)/\theta]^2)}, -\infty&lt;x&lt;\infty,\]</span></p>
<p>where<span class="math inline">\(\theta\)</span> &gt; 0. Compare your results to the results from the R function pcauchy. (Also see the source code in pcauchy.c.)</p>
</div>
<div id="answer-1-6" class="section level2">
<h2>Answer 1</h2>
<p>11.6</p>
<p>Just integrate cdf, we can get pdf</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
f=<span class="cf">function</span>(x,<span class="dt">eta=</span><span class="dv">0</span>,<span class="dt">theta=</span><span class="dv">1</span>){   <span class="co"># function</span>
  <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span>(theta<span class="op">*</span>pi<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>((x<span class="op">-</span>eta)<span class="op">/</span>theta)<span class="op">^</span><span class="dv">2</span>)))
}

res &lt;-<span class="st"> </span><span class="cf">function</span>(y,<span class="dt">eta1=</span><span class="dv">0</span>,<span class="dt">theta1=</span><span class="dv">1</span>){  <span class="co">#integrate</span>
  <span class="kw">integrate</span>(f, <span class="dt">lower=</span><span class="op">-</span><span class="ot">Inf</span>, <span class="dt">upper=</span>y, <span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>,<span class="dt">eta=</span>eta1,<span class="dt">theta=</span>theta1)<span class="op">$</span>value
}</code></pre></div>
<p>Check it</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">res</span>(<span class="op">-</span><span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] 0.1475836</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pcauchy</span>(<span class="op">-</span><span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] 0.1475836</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">res</span>(<span class="dv">0</span>)</code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pcauchy</span>(<span class="dv">0</span>)</code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">res</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] 0.2048328</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pcauchy</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] 0.2048328</code></pre>
<p>The results are good.</p>
</div>
<div id="question-2-5" class="section level2">
<h2>Question 2</h2>
<p>A-B-O blood type problem</p>
<p>Let the three alleles be A, B, and O.</p>
<p>Observed data: nA?? = nAA + nAO = 28 (A-type), nB?? = nBB + nBO = 24 (B-type), nOO = 41 (O-type), nAB = 70 (AB-type).</p>
<p>Use EM algorithm to solve MLE of p and q (consider missing data nAA and nBB).</p>
<p>Record the maximum likelihood values in M-steps, are they increasing?</p>
</div>
<div id="answer-2-5" class="section level2">
<h2>Answer 2</h2>
<p>Use EM algorithm to solve MLE of p and q</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">'nloptr'</span>)
<span class="kw">library</span>(lpSolve);<span class="kw">suppressMessages</span>(<span class="kw">library</span>(quantreg))
N=<span class="dv">1000</span>
na=<span class="dv">28</span>
nb=<span class="dv">24</span>
noo=<span class="dv">41</span>
nab=<span class="dv">70</span>
p=<span class="fl">0.6</span>   <span class="co">#initial est. for p</span>
q=<span class="fl">0.3</span>
r=<span class="fl">0.1</span>
pm=<span class="kw">numeric</span>(<span class="dv">0</span>)
qm=<span class="kw">numeric</span>(<span class="dv">0</span>)
rm=<span class="kw">numeric</span>(<span class="dv">0</span>)
lofm=<span class="kw">numeric</span>(<span class="dv">0</span>)
lof=<span class="cf">function</span>(p,q,r){   <span class="co">#log maximum likelihood values</span>
  <span class="kw">return</span>(<span class="kw">log</span>(<span class="kw">choose</span>(n,naa)<span class="op">*</span><span class="kw">choose</span>(n<span class="op">-</span>naa,nbb)<span class="op">*</span><span class="kw">choose</span>(n<span class="op">-</span>naa<span class="op">-</span>nbb,noo)<span class="op">*</span><span class="kw">choose</span>(nao<span class="op">+</span>nbo<span class="op">+</span>nab,nao)<span class="op">*</span><span class="kw">choose</span>(nbo<span class="op">+</span>nab,nbo))<span class="op">+</span>(nao<span class="op">+</span>nbo<span class="op">+</span>nab)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span>)<span class="op">+</span>(<span class="dv">2</span><span class="op">*</span>naa<span class="op">+</span>nao<span class="op">+</span>nab)<span class="op">*</span><span class="kw">log</span>(p)<span class="op">+</span>(<span class="dv">2</span><span class="op">*</span>nbb<span class="op">+</span>nbo<span class="op">+</span>nab)<span class="op">*</span><span class="kw">log</span>(q)<span class="op">+</span>(<span class="dv">2</span><span class="op">*</span>noo<span class="op">+</span>nao<span class="op">+</span>nbo)<span class="op">*</span><span class="kw">log</span>(r))
}
<span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {
  naa=<span class="kw">round</span>(na<span class="op">*</span>p<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(p<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r))
  nbb=<span class="kw">round</span>(nb<span class="op">*</span>q<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(q<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r))
  nao=na<span class="op">-</span>naa
  nbo=nb<span class="op">-</span>nbb
  n=naa<span class="op">+</span>nbb<span class="op">+</span>noo<span class="op">+</span>nao<span class="op">+</span>nbo<span class="op">+</span>nab
  <span class="cf">if</span>(<span class="kw">abs</span>(p<span class="op">-</span>(<span class="dv">2</span><span class="op">*</span>naa<span class="op">+</span>nao<span class="op">+</span>nab)<span class="op">/</span><span class="dv">2</span><span class="op">/</span>n)<span class="op">&lt;</span><span class="fl">0.000000001</span><span class="op">&amp;&amp;</span><span class="kw">abs</span>(q<span class="op">-</span>(<span class="dv">2</span><span class="op">*</span>nbb<span class="op">+</span>nbo<span class="op">+</span>nab)<span class="op">/</span><span class="dv">2</span><span class="op">/</span>n)<span class="op">&lt;</span><span class="fl">0.000000001</span><span class="op">&amp;&amp;</span><span class="kw">abs</span>(r<span class="op">-</span>(<span class="dv">2</span><span class="op">*</span>noo<span class="op">+</span>nbo<span class="op">+</span>nao)<span class="op">/</span><span class="dv">2</span><span class="op">/</span>n)<span class="op">&lt;</span><span class="fl">0.000000001</span><span class="op">&amp;&amp;</span>j<span class="op">&gt;</span><span class="dv">5</span>) <span class="cf">break</span>
  p=(<span class="dv">2</span><span class="op">*</span>naa<span class="op">+</span>nao<span class="op">+</span>nab)<span class="op">/</span><span class="dv">2</span><span class="op">/</span>n  <span class="co">#update estimation</span>
  q=(<span class="dv">2</span><span class="op">*</span>nbb<span class="op">+</span>nbo<span class="op">+</span>nab)<span class="op">/</span><span class="dv">2</span><span class="op">/</span>n
  r=(<span class="dv">2</span><span class="op">*</span>noo<span class="op">+</span>nbo<span class="op">+</span>nao)<span class="op">/</span><span class="dv">2</span><span class="op">/</span>n
  pm=<span class="kw">c</span>(pm,p)
  qm=<span class="kw">c</span>(qm,q)
  rm=<span class="kw">c</span>(rm,r)
  lofm=<span class="kw">c</span>(lofm,<span class="kw">lof</span>(p,q,r))
}</code></pre></div>
<p>the resualt p,q,r is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(p,q,r)</code></pre></div>
<pre><code>## [1] 0.3282209 0.3098160 0.3619632</code></pre>
<p>in M-steps, the maximum likelihood values is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">exp</span>(lofm)</code></pre></div>
<pre><code>## [1] 6.864600e-29 1.798439e-23 2.908277e-23 2.908277e-23 2.908277e-23</code></pre>
<p>they are increasing</p>
</div>
<div id="question-1-7" class="section level2">
<h2>Question 1</h2>
<p>3</p>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list: formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt )</p>
</div>
<div id="answer-1-7" class="section level2">
<h2>Answer 1</h2>
<p>3</p>
<p>use lapply</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(
mpg <span class="op">~</span><span class="st"> </span>disp,
mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),
mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,
mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt
)

a=<span class="kw">lapply</span>(formulas,<span class="cf">function</span>(i){<span class="kw">lm</span>(i,mtcars)})
a</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p>result is good</p>
</div>
<div id="question-2-6" class="section level2">
<h2>Question 2</h2>
<p>4</p>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function? bootstraps &lt;- lapply(1:10, function(i) { rows &lt;- sample(1:nrow(mtcars), rep = TRUE) mtcars[rows, ] })</p>
</div>
<div id="answer-2-6" class="section level2">
<h2>Answer 2</h2>
<p>use lapply</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {
rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)
mtcars[rows, ]
})

b=<span class="kw">lapply</span>(bootstraps,<span class="cf">function</span>(i){<span class="kw">lm</span>(mpg<span class="op">~</span>disp,i)})
b</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    28.05769     -0.03647  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    29.11683     -0.04082  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    26.57385     -0.02937  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    28.28313     -0.03724  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    31.60253     -0.04562  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##     28.7208      -0.0383  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    27.11226     -0.03166  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    29.34297     -0.04015  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    26.52186     -0.02975  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = i)
## 
## Coefficients:
## (Intercept)         disp  
##    28.06815     -0.03533</code></pre>
<p>result is good</p>
</div>
<div id="question-3-4" class="section level2">
<h2>Question 3</h2>
<p>5</p>
<p>For each model in the previous two exercises, extract R2 using the function below. rsq &lt;- function(mod) summary(mod)$r.squared</p>
</div>
<div id="answer-3-4" class="section level2">
<h2>Answer 3</h2>
<p>use lapply</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared

<span class="kw">lapply</span>(<span class="kw">c</span>(a,b),rsq)</code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038
## 
## [[5]]
## [1] 0.6606581
## 
## [[6]]
## [1] 0.8160798
## 
## [[7]]
## [1] 0.5806448
## 
## [[8]]
## [1] 0.7407087
## 
## [[9]]
## [1] 0.7589143
## 
## [[10]]
## [1] 0.6561107
## 
## [[11]]
## [1] 0.6021043
## 
## [[12]]
## [1] 0.6888394
## 
## [[13]]
## [1] 0.5989015
## 
## [[14]]
## [1] 0.723953</code></pre>
<p>result is good</p>
</div>
<div id="question-4-3" class="section level2">
<h2>Question 4</h2>
<p>3</p>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
</div>
<div id="answer-4-3" class="section level2">
<h2>Answer 4</h2>
<p>use sapply</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(
<span class="dv">100</span>,
<span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),
<span class="dt">simplify =</span> <span class="ot">FALSE</span>
)
<span class="kw">sapply</span>(trials,<span class="cf">function</span>(i){i<span class="op">$</span>p.value})</code></pre></div>
<pre><code>##   [1] 0.944604474 0.371539310 0.605030015 0.110951034 0.521567507
##   [6] 0.637240499 0.796203265 0.868936700 0.827948070 0.387709972
##  [11] 0.597222920 0.288595782 0.273836342 0.773207923 0.779116916
##  [16] 0.673795556 0.094660169 0.879921270 0.151320980 0.381653289
##  [21] 0.128203608 0.185115319 0.128484504 0.601986669 0.785787259
##  [26] 0.907921971 0.355839084 0.075304546 0.129700261 0.753907270
##  [31] 0.444833493 0.443329437 0.306682057 0.281237756 0.526728407
##  [36] 0.285574998 0.332508377 0.732513750 0.024479707 0.905124419
##  [41] 0.447800268 0.953086081 0.922069035 0.337966711 0.527985789
##  [46] 0.143760655 0.309615363 0.436343467 0.977146241 0.834088920
##  [51] 0.797839077 0.419104261 0.240169758 0.854968134 0.087762435
##  [56] 0.343468029 0.942409419 0.976264230 0.114478083 0.599352204
##  [61] 0.192499176 0.639045873 0.034448376 0.944986752 0.496140233
##  [66] 0.234033685 0.046808273 0.610168392 0.155954466 0.749269037
##  [71] 0.906087190 0.647073507 0.297964919 0.058466838 0.177957081
##  [76] 0.171046036 0.942958116 0.152387382 0.293210859 0.938654444
##  [81] 0.669734585 0.714559245 0.938578220 0.136882753 0.289616995
##  [86] 0.197960287 0.045491880 0.297420282 0.550368727 0.673067405
##  [91] 0.285852753 0.002039242 0.059096244 0.413567213 0.886147502
##  [96] 0.291682172 0.602694355 0.279349884 0.596604292 0.186684999</code></pre>
<p>result is good</p>
</div>
<div id="question-5" class="section level2">
<h2>Question 5</h2>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer 5</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">library</span>(parallel)
<span class="kw">library</span>(foreach)

<span class="co">#parallel</span>
mcvMap=<span class="cf">function</span>(f, FUN.VALUE , ...) {
    out=<span class="kw">Map</span>(f, ...)
    <span class="kw">vapply</span>(out, FUN, FUN.VALUE)
}


<span class="co">#foreach</span>
y=<span class="kw">foreach</span>(<span class="dt">x=</span><span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>,<span class="dt">.combine=</span><span class="st">'rbind'</span>) <span class="op">%do%</span><span class="st"> </span><span class="kw">exp</span>(x)</code></pre></div>
</div>
<div id="question-1-8" class="section level2">
<h2>Question 1</h2>
<p>4</p>
<p>Make a faster version of chisq.test() that only computes the chi-square test statistic when the input is two numeric vectors with no missing values. You can try simplifying chisq.test() or by coding from the mathematical definition .</p>
</div>
<div id="answer-1-8" class="section level2">
<h2>Answer 1</h2>
<p>4</p>
<p>first, write the function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fas.chi=<span class="cf">function</span> (x, <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">correct =</span> <span class="ot">TRUE</span>, <span class="dt">p =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">/</span><span class="kw">length</span>(x), <span class="kw">length</span>(x)), 
          <span class="dt">rescale.p =</span> <span class="ot">FALSE</span>, <span class="dt">simulate.p.value =</span> <span class="ot">FALSE</span>, <span class="dt">B =</span> <span class="dv">2000</span>) 
{
  DNAME &lt;-<span class="st"> </span><span class="kw">deparse</span>(<span class="kw">substitute</span>(x))
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.matrix</span>(x) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(y)) {
    <span class="cf">if</span> (<span class="kw">length</span>(x) <span class="op">!=</span><span class="st"> </span><span class="kw">length</span>(y)) 
      <span class="kw">stop</span>(<span class="st">&quot;'x' and 'y' must have the same length&quot;</span>)
    DNAME2 &lt;-<span class="st"> </span><span class="kw">deparse</span>(<span class="kw">substitute</span>(y))
    xname &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="kw">length</span>(DNAME) <span class="op">&gt;</span><span class="st"> </span>1L <span class="op">||</span><span class="st"> </span><span class="kw">nchar</span>(DNAME, <span class="st">&quot;w&quot;</span>) <span class="op">&gt;</span><span class="st"> </span>
<span class="st">                 </span><span class="dv">30</span>) 
      <span class="st">&quot;&quot;</span>
    <span class="cf">else</span> DNAME
    yname &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="kw">length</span>(DNAME2) <span class="op">&gt;</span><span class="st"> </span>1L <span class="op">||</span><span class="st"> </span><span class="kw">nchar</span>(DNAME2, <span class="st">&quot;w&quot;</span>) <span class="op">&gt;</span><span class="st"> </span>
<span class="st">                 </span><span class="dv">30</span>) 
      <span class="st">&quot;&quot;</span>
    <span class="cf">else</span> DNAME2
    OK &lt;-<span class="st"> </span><span class="kw">complete.cases</span>(x, y)
    x &lt;-<span class="st"> </span><span class="kw">factor</span>(x[OK])
    y &lt;-<span class="st"> </span><span class="kw">factor</span>(y[OK])
    <span class="cf">if</span> ((<span class="kw">nlevels</span>(x) <span class="op">&lt;</span><span class="st"> </span>2L) <span class="op">||</span><span class="st"> </span>(<span class="kw">nlevels</span>(y) <span class="op">&lt;</span><span class="st"> </span>2L)) 
      <span class="kw">stop</span>(<span class="st">&quot;'x' and 'y' must have at least 2 levels&quot;</span>)
    x &lt;-<span class="st"> </span><span class="kw">table</span>(x, y)
    <span class="kw">names</span>(<span class="kw">dimnames</span>(x)) &lt;-<span class="st"> </span><span class="kw">c</span>(xname, yname)
    DNAME &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">paste</span>(DNAME, <span class="dt">collapse =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>), <span class="st">&quot;and&quot;</span>, 
                   <span class="kw">paste</span>(DNAME2, <span class="dt">collapse =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>))
  }
  <span class="cf">if</span> (<span class="kw">any</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">||</span><span class="st"> </span><span class="kw">anyNA</span>(x)) 
    <span class="kw">stop</span>(<span class="st">&quot;all entries of 'x' must be nonnegative and finite&quot;</span>)
  <span class="cf">if</span> ((n &lt;-<span class="st"> </span><span class="kw">sum</span>(x)) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) 
    <span class="kw">stop</span>(<span class="st">&quot;at least one entry of 'x' must be positive&quot;</span>)
  <span class="cf">if</span> (<span class="kw">is.matrix</span>(x)) {
    METHOD &lt;-<span class="st"> &quot;Pearson's Chi-squared test&quot;</span>
    nr &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">nrow</span>(x))
    nc &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">ncol</span>(x))
    <span class="cf">if</span> (<span class="kw">is.na</span>(nr) <span class="op">||</span><span class="st"> </span><span class="kw">is.na</span>(nc) <span class="op">||</span><span class="st"> </span><span class="kw">is.na</span>(nr <span class="op">*</span><span class="st"> </span>nc)) 
      <span class="kw">stop</span>(<span class="st">&quot;invalid nrow(x) or ncol(x)&quot;</span>, <span class="dt">domain =</span> <span class="ot">NA</span>)
    sr &lt;-<span class="st"> </span><span class="kw">rowSums</span>(x)
    sc &lt;-<span class="st"> </span><span class="kw">colSums</span>(x)
    E &lt;-<span class="st"> </span><span class="kw">outer</span>(sr, sc, <span class="st">&quot;*&quot;</span>)<span class="op">/</span>n
    v &lt;-<span class="st"> </span><span class="cf">function</span>(r, c, n) c <span class="op">*</span><span class="st"> </span>r <span class="op">*</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span>r) <span class="op">*</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span>c)<span class="op">/</span>n<span class="op">^</span><span class="dv">3</span>
    V &lt;-<span class="st"> </span><span class="kw">outer</span>(sr, sc, v, n)
    <span class="kw">dimnames</span>(E) &lt;-<span class="st"> </span><span class="kw">dimnames</span>(x)
    <span class="cf">if</span> (simulate.p.value <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">all</span>(sr <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">all</span>(sc <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)) {
      <span class="kw">setMETH</span>()
      tmp &lt;-<span class="st"> </span><span class="kw">.Call</span>(C_chisq_sim, sr, sc, B, E)
      STATISTIC &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">sort</span>((x <span class="op">-</span><span class="st"> </span>E)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>E, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>))
      PARAMETER &lt;-<span class="st"> </span><span class="ot">NA</span>
      PVAL &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(tmp <span class="op">&gt;=</span><span class="st"> </span>almost.<span class="dv">1</span> <span class="op">*</span><span class="st"> </span>STATISTIC))<span class="op">/</span>(B <span class="op">+</span><span class="st"> </span>
<span class="st">                                                        </span><span class="dv">1</span>)
    }
    <span class="cf">else</span> {
      <span class="cf">if</span> (simulate.p.value) 
        <span class="kw">warning</span>(<span class="st">&quot;cannot compute simulated p-value with zero marginals&quot;</span>)
      <span class="cf">if</span> (correct <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">nrow</span>(x) <span class="op">==</span><span class="st"> </span>2L <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">ncol</span>(x) <span class="op">==</span><span class="st"> </span>2L) {
        YATES &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="fl">0.5</span>, <span class="kw">abs</span>(x <span class="op">-</span><span class="st"> </span>E))
        <span class="cf">if</span> (YATES <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) 
          METHOD &lt;-<span class="st"> </span><span class="kw">paste</span>(METHOD, <span class="st">&quot;with Yates' continuity correction&quot;</span>)
      }
      <span class="cf">else</span> YATES &lt;-<span class="st"> </span><span class="dv">0</span>
      STATISTIC &lt;-<span class="st"> </span><span class="kw">sum</span>((<span class="kw">abs</span>(x <span class="op">-</span><span class="st"> </span>E) <span class="op">-</span><span class="st"> </span>YATES)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>E)
      PARAMETER &lt;-<span class="st"> </span>(nr <span class="op">-</span><span class="st"> </span>1L) <span class="op">*</span><span class="st"> </span>(nc <span class="op">-</span><span class="st"> </span>1L)
      PVAL &lt;-<span class="st"> </span><span class="kw">pchisq</span>(STATISTIC, PARAMETER, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)
    }
  }
  <span class="cf">else</span> {
    <span class="cf">if</span> (<span class="kw">length</span>(<span class="kw">dim</span>(x)) <span class="op">&gt;</span><span class="st"> </span>2L) 
      <span class="kw">stop</span>(<span class="st">&quot;invalid 'x'&quot;</span>)
    <span class="cf">if</span> (<span class="kw">length</span>(x) <span class="op">==</span><span class="st"> </span>1L) 
      <span class="kw">stop</span>(<span class="st">&quot;'x' must at least have 2 elements&quot;</span>)
    <span class="cf">if</span> (<span class="kw">length</span>(x) <span class="op">!=</span><span class="st"> </span><span class="kw">length</span>(p)) 
      <span class="kw">stop</span>(<span class="st">&quot;'x' and 'p' must have the same number of elements&quot;</span>)
    <span class="cf">if</span> (<span class="kw">any</span>(p <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)) 
      <span class="kw">stop</span>(<span class="st">&quot;probabilities must be non-negative.&quot;</span>)
    <span class="cf">if</span> (<span class="kw">abs</span>(<span class="kw">sum</span>(p) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&gt;</span><span class="st"> </span><span class="kw">sqrt</span>(.Machine<span class="op">$</span>double.eps)) {
      <span class="cf">if</span> (rescale.p) 
        p &lt;-<span class="st"> </span>p<span class="op">/</span><span class="kw">sum</span>(p)
      <span class="cf">else</span> <span class="kw">stop</span>(<span class="st">&quot;probabilities must sum to 1.&quot;</span>)
    }
    METHOD &lt;-<span class="st"> &quot;Chi-squared test for given probabilities&quot;</span>
    E &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span>p
    V &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span>p <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p)
    STATISTIC &lt;-<span class="st"> </span><span class="kw">sum</span>((x <span class="op">-</span><span class="st"> </span>E)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>E)
    <span class="kw">names</span>(E) &lt;-<span class="st"> </span><span class="kw">names</span>(x)
  }
  <span class="kw">names</span>(STATISTIC) &lt;-<span class="st"> &quot;X-squared&quot;</span>
  <span class="kw">names</span>(PARAMETER) &lt;-<span class="st"> &quot;df&quot;</span>
  <span class="kw">return</span>(STATISTIC)
}</code></pre></div>
<p>test it</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">434</span>)
b=<span class="kw">c</span>(<span class="dv">325</span>,<span class="dv">645</span>,<span class="dv">75</span>,<span class="dv">7</span>,<span class="dv">23</span>,<span class="dv">352</span>)
<span class="kw">fas.chi</span>(a,b)</code></pre></div>
<pre><code>## X-squared 
##        30</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(a,b)</code></pre></div>
<pre><code>## Warning in chisq.test(a, b): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## 
##  Pearson's Chi-squared test
## 
## data:  a and b
## X-squared = 30, df = 25, p-value = 0.2243</code></pre>
<p>result is same to “chisq.test”, and this function is faster, answer is right</p>
</div>
<div id="question-2-7" class="section level2">
<h2>Question 2</h2>
<p>5</p>
<p>Can you make a faster version of table() for the case of an input of two integer vectors with no missing values? Can you use it to speed up your chi-square test?</p>
</div>
<div id="answer-2-7" class="section level2">
<h2>Answer 2</h2>
<p>yes, I can.</p>
<p>first, write the function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fas.tab=<span class="cf">function</span> (...,   <span class="dt">dnn =</span> <span class="kw">list.names</span>(...), <span class="dt">deparse.level =</span> <span class="dv">1</span>) 
{
    list.names &lt;-<span class="st"> </span><span class="cf">function</span>(...) {
        l &lt;-<span class="st"> </span><span class="kw">as.list</span>(<span class="kw">substitute</span>(<span class="kw">list</span>(...)))[<span class="op">-</span>1L]
        nm &lt;-<span class="st"> </span><span class="kw">names</span>(l)
        fixup &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="kw">is.null</span>(nm)) 
            <span class="kw">seq_along</span>(l)
        <span class="cf">else</span> nm <span class="op">==</span><span class="st"> &quot;&quot;</span>
        dep &lt;-<span class="st"> </span><span class="kw">vapply</span>(l[fixup], <span class="cf">function</span>(x) <span class="cf">switch</span>(deparse.level <span class="op">+</span><span class="st"> </span>
<span class="st">            </span><span class="dv">1</span>, <span class="st">&quot;&quot;</span>, <span class="cf">if</span> (<span class="kw">is.symbol</span>(x)) <span class="kw">as.character</span>(x) <span class="cf">else</span> <span class="st">&quot;&quot;</span>, 
            <span class="kw">deparse</span>(x, <span class="dt">nlines =</span> <span class="dv">1</span>)[1L]), <span class="st">&quot;&quot;</span>)
        <span class="cf">if</span> (<span class="kw">is.null</span>(nm)) 
            dep
        <span class="cf">else</span> {
            nm[fixup] &lt;-<span class="st"> </span>dep
            nm
        }
    }
    
    args &lt;-<span class="st"> </span><span class="kw">list</span>(...)
    <span class="cf">if</span> (<span class="op">!</span><span class="kw">length</span>(args)) 
        <span class="kw">stop</span>(<span class="st">&quot;nothing to tabulate&quot;</span>)
    <span class="cf">if</span> (<span class="kw">length</span>(args) <span class="op">==</span><span class="st"> </span>1L <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">is.list</span>(args[[1L]])) {
        args &lt;-<span class="st"> </span>args[[1L]]
        <span class="cf">if</span> (<span class="kw">length</span>(dnn) <span class="op">!=</span><span class="st"> </span><span class="kw">length</span>(args)) 
            dnn &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(argn &lt;-<span class="st"> </span><span class="kw">names</span>(args))) 
                argn
            <span class="cf">else</span> <span class="kw">paste</span>(dnn[1L], <span class="kw">seq_along</span>(args), <span class="dt">sep =</span> <span class="st">&quot;.&quot;</span>)
    }
    bin &lt;-<span class="st"> </span>0L
    lens &lt;-<span class="st"> </span><span class="ot">NULL</span>
    dims &lt;-<span class="st"> </span><span class="kw">integer</span>()
    pd &lt;-<span class="st"> </span>1L
    dn &lt;-<span class="st"> </span><span class="ot">NULL</span>
    <span class="cf">for</span> (a <span class="cf">in</span> args) {
        <span class="cf">if</span> (<span class="kw">is.null</span>(lens)) 
            lens &lt;-<span class="st"> </span><span class="kw">length</span>(a)
        <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">length</span>(a) <span class="op">!=</span><span class="st"> </span>lens) 
            <span class="kw">stop</span>(<span class="st">&quot;all arguments must have the same length&quot;</span>)
        cat &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="kw">is.factor</span>(a)) {
            <span class="cf">if</span> (<span class="kw">any</span>(<span class="kw">is.na</span>(<span class="kw">levels</span>(a)))) 
                a

        }
        <span class="cf">else</span> {
            a &lt;-<span class="st"> </span><span class="kw">factor</span>(a)
            a
        }
        nl &lt;-<span class="st"> </span><span class="kw">length</span>(ll &lt;-<span class="st"> </span><span class="kw">levels</span>(cat))
        dims &lt;-<span class="st"> </span><span class="kw">c</span>(dims, nl)
        <span class="cf">if</span> (<span class="kw">prod</span>(dims) <span class="op">&gt;</span><span class="st"> </span>.Machine<span class="op">$</span>integer.max) 
            <span class="kw">stop</span>(<span class="st">&quot;attempt to make a table with &gt;= 2^31 elements&quot;</span>)
        dn &lt;-<span class="st"> </span><span class="kw">c</span>(dn, <span class="kw">list</span>(ll))
        bin &lt;-<span class="st"> </span>bin <span class="op">+</span><span class="st"> </span>pd <span class="op">*</span><span class="st"> </span>(<span class="kw">as.integer</span>(cat) <span class="op">-</span><span class="st"> </span>1L)
        pd &lt;-<span class="st"> </span>pd <span class="op">*</span><span class="st"> </span>nl
    }
    <span class="kw">names</span>(dn) &lt;-<span class="st"> </span>dnn
    bin &lt;-<span class="st"> </span>bin[<span class="op">!</span><span class="kw">is.na</span>(bin)]
    <span class="cf">if</span> (<span class="kw">length</span>(bin)) 
        bin &lt;-<span class="st"> </span>bin <span class="op">+</span><span class="st"> </span>1L
    y &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">tabulate</span>(bin, pd), dims, <span class="dt">dimnames =</span> dn)
    <span class="kw">class</span>(y) &lt;-<span class="st"> &quot;table&quot;</span>
    y
}</code></pre></div>
<p>test it</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fas.tab</span>(a,b)</code></pre></div>
<pre><code>##      b
## a     7 23 75 325 352 645
##   1   0  0  0   1   0   0
##   5   0  0  1   0   0   0
##   6   1  0  0   0   0   0
##   7   0  1  0   0   0   0
##   24  0  0  0   0   0   1
##   434 0  0  0   0   1   0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(a,b)</code></pre></div>
<pre><code>##      b
## a     7 23 75 325 352 645
##   1   0  0  0   1   0   0
##   5   0  0  1   0   0   0
##   6   1  0  0   0   0   0
##   7   0  1  0   0   0   0
##   24  0  0  0   0   0   1
##   434 0  0  0   0   1   0</code></pre>
<p>same to “table”, answer is right</p>
<p>can speed up my chi-square test</p>
<p>replace “table” with new function “fas.tab”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fas.chi2=<span class="cf">function</span> (x, <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">correct =</span> <span class="ot">TRUE</span>, <span class="dt">p =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">/</span><span class="kw">length</span>(x), <span class="kw">length</span>(x)), 
          <span class="dt">rescale.p =</span> <span class="ot">FALSE</span>, <span class="dt">simulate.p.value =</span> <span class="ot">FALSE</span>, <span class="dt">B =</span> <span class="dv">2000</span>) 
{
  DNAME &lt;-<span class="st"> </span><span class="kw">deparse</span>(<span class="kw">substitute</span>(x))
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.matrix</span>(x) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.null</span>(y)) {
    <span class="cf">if</span> (<span class="kw">length</span>(x) <span class="op">!=</span><span class="st"> </span><span class="kw">length</span>(y)) 
      <span class="kw">stop</span>(<span class="st">&quot;'x' and 'y' must have the same length&quot;</span>)
    DNAME2 &lt;-<span class="st"> </span><span class="kw">deparse</span>(<span class="kw">substitute</span>(y))
    xname &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="kw">length</span>(DNAME) <span class="op">&gt;</span><span class="st"> </span>1L <span class="op">||</span><span class="st"> </span><span class="kw">nchar</span>(DNAME, <span class="st">&quot;w&quot;</span>) <span class="op">&gt;</span><span class="st"> </span>
<span class="st">                 </span><span class="dv">30</span>) 
      <span class="st">&quot;&quot;</span>
    <span class="cf">else</span> DNAME
    yname &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="kw">length</span>(DNAME2) <span class="op">&gt;</span><span class="st"> </span>1L <span class="op">||</span><span class="st"> </span><span class="kw">nchar</span>(DNAME2, <span class="st">&quot;w&quot;</span>) <span class="op">&gt;</span><span class="st"> </span>
<span class="st">                 </span><span class="dv">30</span>) 
      <span class="st">&quot;&quot;</span>
    <span class="cf">else</span> DNAME2
    OK &lt;-<span class="st"> </span><span class="kw">complete.cases</span>(x, y)
    x &lt;-<span class="st"> </span><span class="kw">factor</span>(x[OK])
    y &lt;-<span class="st"> </span><span class="kw">factor</span>(y[OK])
    <span class="cf">if</span> ((<span class="kw">nlevels</span>(x) <span class="op">&lt;</span><span class="st"> </span>2L) <span class="op">||</span><span class="st"> </span>(<span class="kw">nlevels</span>(y) <span class="op">&lt;</span><span class="st"> </span>2L)) 
      <span class="kw">stop</span>(<span class="st">&quot;'x' and 'y' must have at least 2 levels&quot;</span>)
    x &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="kw">as.numeric</span>(<span class="kw">as.vector</span>(x)), <span class="kw">as.numeric</span>(<span class="kw">as.vector</span>(y)))
    <span class="kw">names</span>(<span class="kw">dimnames</span>(x)) &lt;-<span class="st"> </span><span class="kw">c</span>(xname, yname)
    DNAME &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">paste</span>(DNAME, <span class="dt">collapse =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>), <span class="st">&quot;and&quot;</span>, 
                   <span class="kw">paste</span>(DNAME2, <span class="dt">collapse =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>))
  }
  <span class="cf">if</span> (<span class="kw">any</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">||</span><span class="st"> </span><span class="kw">anyNA</span>(x)) 
    <span class="kw">stop</span>(<span class="st">&quot;all entries of 'x' must be nonnegative and finite&quot;</span>)
  <span class="cf">if</span> ((n &lt;-<span class="st"> </span><span class="kw">sum</span>(x)) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) 
    <span class="kw">stop</span>(<span class="st">&quot;at least one entry of 'x' must be positive&quot;</span>)
  <span class="cf">if</span> (<span class="kw">is.matrix</span>(x)) {
    METHOD &lt;-<span class="st"> &quot;Pearson's Chi-squared test&quot;</span>
    nr &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">nrow</span>(x))
    nc &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">ncol</span>(x))
    <span class="cf">if</span> (<span class="kw">is.na</span>(nr) <span class="op">||</span><span class="st"> </span><span class="kw">is.na</span>(nc) <span class="op">||</span><span class="st"> </span><span class="kw">is.na</span>(nr <span class="op">*</span><span class="st"> </span>nc)) 
      <span class="kw">stop</span>(<span class="st">&quot;invalid nrow(x) or ncol(x)&quot;</span>, <span class="dt">domain =</span> <span class="ot">NA</span>)
    sr &lt;-<span class="st"> </span><span class="kw">rowSums</span>(x)
    sc &lt;-<span class="st"> </span><span class="kw">colSums</span>(x)
    E &lt;-<span class="st"> </span><span class="kw">outer</span>(sr, sc, <span class="st">&quot;*&quot;</span>)<span class="op">/</span>n
    v &lt;-<span class="st"> </span><span class="cf">function</span>(r, c, n) c <span class="op">*</span><span class="st"> </span>r <span class="op">*</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span>r) <span class="op">*</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span>c)<span class="op">/</span>n<span class="op">^</span><span class="dv">3</span>
    V &lt;-<span class="st"> </span><span class="kw">outer</span>(sr, sc, v, n)
    <span class="kw">dimnames</span>(E) &lt;-<span class="st"> </span><span class="kw">dimnames</span>(x)
    <span class="cf">if</span> (simulate.p.value <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">all</span>(sr <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">all</span>(sc <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)) {
      <span class="kw">setMETH</span>()
      tmp &lt;-<span class="st"> </span><span class="kw">.Call</span>(C_chisq_sim, sr, sc, B, E)
      STATISTIC &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">sort</span>((x <span class="op">-</span><span class="st"> </span>E)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>E, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>))
      PARAMETER &lt;-<span class="st"> </span><span class="ot">NA</span>
      PVAL &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(tmp <span class="op">&gt;=</span><span class="st"> </span>almost.<span class="dv">1</span> <span class="op">*</span><span class="st"> </span>STATISTIC))<span class="op">/</span>(B <span class="op">+</span><span class="st"> </span>
<span class="st">                                                        </span><span class="dv">1</span>)
    }
    <span class="cf">else</span> {
      <span class="cf">if</span> (simulate.p.value) 
        <span class="kw">warning</span>(<span class="st">&quot;cannot compute simulated p-value with zero marginals&quot;</span>)
      <span class="cf">if</span> (correct <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">nrow</span>(x) <span class="op">==</span><span class="st"> </span>2L <span class="op">&amp;&amp;</span><span class="st"> </span><span class="kw">ncol</span>(x) <span class="op">==</span><span class="st"> </span>2L) {
        YATES &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="fl">0.5</span>, <span class="kw">abs</span>(x <span class="op">-</span><span class="st"> </span>E))
        <span class="cf">if</span> (YATES <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) 
          METHOD &lt;-<span class="st"> </span><span class="kw">paste</span>(METHOD, <span class="st">&quot;with Yates' continuity correction&quot;</span>)
      }
      <span class="cf">else</span> YATES &lt;-<span class="st"> </span><span class="dv">0</span>
      STATISTIC &lt;-<span class="st"> </span><span class="kw">sum</span>((<span class="kw">abs</span>(x <span class="op">-</span><span class="st"> </span>E) <span class="op">-</span><span class="st"> </span>YATES)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>E)
      PARAMETER &lt;-<span class="st"> </span>(nr <span class="op">-</span><span class="st"> </span>1L) <span class="op">*</span><span class="st"> </span>(nc <span class="op">-</span><span class="st"> </span>1L)
      PVAL &lt;-<span class="st"> </span><span class="kw">pchisq</span>(STATISTIC, PARAMETER, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)
    }
  }
  <span class="cf">else</span> {
    <span class="cf">if</span> (<span class="kw">length</span>(<span class="kw">dim</span>(x)) <span class="op">&gt;</span><span class="st"> </span>2L) 
      <span class="kw">stop</span>(<span class="st">&quot;invalid 'x'&quot;</span>)
    <span class="cf">if</span> (<span class="kw">length</span>(x) <span class="op">==</span><span class="st"> </span>1L) 
      <span class="kw">stop</span>(<span class="st">&quot;'x' must at least have 2 elements&quot;</span>)
    <span class="cf">if</span> (<span class="kw">length</span>(x) <span class="op">!=</span><span class="st"> </span><span class="kw">length</span>(p)) 
      <span class="kw">stop</span>(<span class="st">&quot;'x' and 'p' must have the same number of elements&quot;</span>)
    <span class="cf">if</span> (<span class="kw">any</span>(p <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)) 
      <span class="kw">stop</span>(<span class="st">&quot;probabilities must be non-negative.&quot;</span>)
    <span class="cf">if</span> (<span class="kw">abs</span>(<span class="kw">sum</span>(p) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">&gt;</span><span class="st"> </span><span class="kw">sqrt</span>(.Machine<span class="op">$</span>double.eps)) {
      <span class="cf">if</span> (rescale.p) 
        p &lt;-<span class="st"> </span>p<span class="op">/</span><span class="kw">sum</span>(p)
      <span class="cf">else</span> <span class="kw">stop</span>(<span class="st">&quot;probabilities must sum to 1.&quot;</span>)
    }
    METHOD &lt;-<span class="st"> &quot;Chi-squared test for given probabilities&quot;</span>
    E &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span>p
    V &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span>p <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p)
    STATISTIC &lt;-<span class="st"> </span><span class="kw">sum</span>((x <span class="op">-</span><span class="st"> </span>E)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>E)
    <span class="kw">names</span>(E) &lt;-<span class="st"> </span><span class="kw">names</span>(x)
  }
  <span class="kw">names</span>(STATISTIC) &lt;-<span class="st"> &quot;X-squared&quot;</span>
  <span class="kw">names</span>(PARAMETER) &lt;-<span class="st"> &quot;df&quot;</span>
  <span class="kw">return</span>(STATISTIC)
}</code></pre></div>
<p>test it</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">434</span>)
b=<span class="kw">c</span>(<span class="dv">325</span>,<span class="dv">645</span>,<span class="dv">75</span>,<span class="dv">7</span>,<span class="dv">23</span>,<span class="dv">352</span>)
<span class="kw">fas.chi2</span>(a,b)</code></pre></div>
<pre><code>## X-squared 
##        30</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
